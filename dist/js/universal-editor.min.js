function UniversalEditor(e,t){"use strict";var i=angular.module("universal.editor"),a=$("#"+e);a.append("<div data-ui-view=''></div>"),i.constant("configData",t),angular.bootstrap(a[0],["unEditor"])}!function(){"use strict";function e(e,t,i,a){return{request:function(e){return t.$broadcast("editor:request_start",""),e.data&&"object"==typeof e.data&&angular.forEach(e.data,function(t,i){angular.isArray(t)&&0===t.length&&(e.data[i]=null)}),e},responseError:function(t){if(t.status===-1)return Raven.captureMessage("Сервис временно недоступен."),a("RESPONSE_ERROR.SERVICE_UNAVAILABLE").then(function(e){i.error(e)}),e.reject(t);try{JSON.parse(JSON.stringify(t))}catch(n){return Raven.captureException(n),void a("RESPONSE_ERROR.SERVICE_UNAVAILABLE").then(function(e){i.error(e)})}return angular.isObject(t)?(t.data.hasOwnProperty("code")&&t.data.hasOwnProperty("type")?("error"==t.data.type&&"auth_needed"==t.data.code&&(Raven.captureMessage("Требуется повторная авторизация, перезагрузите страницу."),a("RESPONSE_ERROR.RELOAD_PAGE").then(function(e){i.error(e)})),"error"==t.data.type&&"auth_incorrect"==t.data.code&&(Raven.captureMessage("Требуется повторная авторизация, перезагрузите страницу."),a("RESPONSE_ERROR.RELOAD_PAGE").then(function(e){i.error(e)})),"error"==t.data.type&&"not_found"==t.data.code&&(Raven.captureMessage("Запись не найдена."),a("RESPONSE_ERROR.NOT_FOUND").then(function(e){i.error(e)})),"error"==t.data.type&&"wrong_entity"==t.data.code&&(Raven.captureMessage("Сервис временно недоступен."),a("RESPONSE_ERROR.SERVICE_UNAVAILABLE").then(function(e){i.error(e)})),"error"==t.data.type&&"invalid_data"==t.data.code&&a("RESPONSE_ERROR.INVALID_DATA").then(function(e){i.error(e)}),"critical"==t.data.type&&(Raven.captureMessage("Сервис временно недоступен."),a("RESPONSE_ERROR.SERVICE_UNAVAILABLE").then(function(e){i.error(e)}))):(Raven.captureMessage("Сервис временно недоступен."),a("RESPONSE_ERROR.SERVICE_UNAVAILABLE").then(function(e){i.error(e)})),e.reject(t)):(Raven.captureMessage("Сервис временно недоступен."),a("RESPONSE_ERROR.SERVICE_UNAVAILABLE").then(function(e){i.error(e)}),e.reject(t))}}}function t(e,t,i,n,l,r,d){angular.extend(e.defaults,{control:"hue",position:"top left",letterCase:"uppercase"}),t.defaults.paramSerializer="$httpParamSerializerJQLike",t.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",t.defaults.transformRequest=function(e){return void 0===e?e:$.param(e)},t.interceptors.push("EditorHttpInterceptor");var o=r.getNameDefaultEntity(),u=r.getLangDefaultEntity();n.otherwise("/editor/"+o+"/list"+u),i.state("editor",{url:"/editor",template:"<div data-ui-view></div>"}).state("editor.type",{url:"/:type",template:"<div data-ui-view></div>",resolve:{configObject:a},controller:"UniversalEditorController",controllerAs:"vm",onEnter:["RestApiService","$stateParams",function(e,t){}]}).state("editor.type.list",{url:"/list?parent&lang",templateUrl:"module/directives/universalEditor/universalEditorList.html",onEnter:["RestApiService","$stateParams",function(e,t){e.setEntityType(t.type,t.lang),e.getItemsList()}]}).state("editor.type.new",{url:"/new?parent&type&lang",templateUrl:"module/directives/universalEditor/universalEditorForm.html",onEnter:["RestApiService","EditEntityStorage","$stateParams",function(e,t,i){e.setEntityType(i.type,i.lang),t.createNewEntity(i)}]}).state("editor.type.entity",{url:"/:uid?back&parent&lang&if-not-exist",templateUrl:"module/directives/universalEditor/universalEditorForm.html",onEnter:["RestApiService","EditEntityStorage","$rootScope","$stateParams",function(e,t,i,a){e.setEntityType(a.type,a.lang),e.getItemById(a.uid)}]}),l.decorator("mFormatFilter",function(){return function(e,t,i){return moment.isMoment(e)?i?moment.tz(e,i).format(t):e.format(t):""}})}function i(e,t,i){var a=document.querySelectorAll(".nav.nav-tabs .item");e.$on("$stateChangeSuccess",function(e,t,i){var n=i.type;angular.forEach(a,function(e){$(e).removeClass("active"),$(e).find("a")[0].hash.split("/")[2]==n&&$(e).addClass("active")})}),1==a.length&&angular.element(a).css("display","none")}function a(e){return e}angular.module("universal.editor",["universal.editor.templates","minicolors","ui.tinymce","datePicker","checklist-model","angularMoment","ngCookies","ngFileUpload","ui.router","yaMap","ngRaven","ui.mask","toastr","pascalprecht.translate"]),angular.module("universal.editor").factory("EditorHttpInterceptor",e),e.$inject=["$q","$rootScope","toastr","$translate"],angular.module("universal.editor").config(t),t.$inject=["minicolorsProvider","$httpProvider","$stateProvider","$urlRouterProvider","$provide","ConfigDataProviderProvider","$injector"],angular.module("universal.editor").run(i),i.$inject=["$rootScope","$location","$state"],a.$inject=["ConfigDataProvider"]}(),function(){"use strict";function e(e){var t={RESPONSE_ERROR:{INVALID_DATA:"Неправильно заполнена форма.",SERVICE_UNAVAILABLE:"Сервис временно недоступен.",RELOAD_PAGE:"Требуется повторная авторизация, перезагрузите страницу.",NOT_FOUND:"Запись не найдена."},CHANGE_RECORDS:{CREATE:"Запись создана.",UPDATE:"Запись обновлена.",DELETE:"Запись удалена."},BUTTON:{ADD:"Добавить",DELETE:"Удалить",DELETE_MARK:"Удалить метку",APPLY:"Применить",CLEAN:"Очистить",HIGHER_LEVEL:"На уровень выше",FILTER:"Фильтр"},LOADING:"Загрузка",SELECT_VALUE:"Выберите значение",PERFORMS_ACTIONS:"Выполняется действие",ELEMENT_NO:"Нет элементов для отображения",ELEMENTS:"Элементы",FROM:"из",SEARCH_ELEMENTS:"Поиск по элементам"};e.translations("ru",t),e.useStaticFilesLoader({prefix:"",suffix:""}),e.preferredLanguage("ru")}angular.module("universal.editor").config(e),e.$inject=["$translateProvider"]}(),function(){"use strict";function e(e){var t=function(e){this.scope=e.$new(),this.scope.field=e.field};return t.prototype.build=function(){var t="<div data-editor-field-"+this.scope.field.type+'=""></div>';return e(t)(this.scope)},t}angular.module("universal.editor").factory("FieldBuilder",e),e.$inject=["$compile"]}(),function(){"use strict";function e(e){var t=function(e){this.scope=e.$new(),this.scope.filter=e.filter};return t.prototype.build=function(){var t="<div data-editor-filter-"+this.scope.filter.type+'=""></div>';return e(t)(this.scope)},t}angular.module("universal.editor").factory("FilterBuilder",e),e.$inject=["$compile"]}(),function(){"use strict";function e(e){return{getNameDefaultEntity:function(){return e.entities[0].name},getLangDefaultEntity:function(){return e.entities[0].lang?"?lang="+e.entities[0].lang:""},$get:["$q",function(t){var i=t.defer();return i.resolve(e),i}]}}angular.module("universal.editor").provider("ConfigDataProvider",e),e.$inject=["configData"]}(),function(){"use strict";function e(e){var t={};this.setArrayField=function(e,i){t[e]=i},this.getFieldValue=function(e,i,a){return!(!t.hasOwnProperty(e)||void 0===t[e][i]||!t[e][i].hasOwnProperty(a))&&t[e][i][a]},this.removeFieldIndex=function(e,i){t[e].splice(i,1)},this.fieldDestroy=function(e,i,a,n){void 0===t[e][i]?(t[e][i]={},t[e][i][a]=n):t[e][i][a]=n},e.$on("editor:set_entity_type",function(e,i){t=[]})}angular.module("universal.editor").service("ArrayFieldStorage",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t,i,a,n,l){var r,d=[],o=this;this.actionType="create",this.getValueField=function(e){for(var t=d.length;t--;){var i=d[t];if(i.fieldName===e)return i.getFieldValue()}},this.createNewEntity=function(a){var l={};l.editorEntityType="new",angular.forEach(d,function(e){angular.merge(l,e.getInitialValue())});var r=a,o=r.type?r.type:n.params.type,u=void 0,s=i.entities.filter(function(e){return e.name===o});if(s.length>1?s.forEach(function(e){e.lang===r.lang&&(u=e)}):u=s[0],r.hasOwnProperty("parent")&&r.parent&&(l[u.backend.fields.parent]=r.parent),"create"===r["if-not-exist"]){var c="id",m="lang";u.backend.hasOwnProperty("fields")&&(c=u.backend.fields.primaryKey?u.backend.fields.primaryKey:c,m=u.backend.fields.language?u.backend.fields.language:m),l[c]=a.uid,l[m]=r.lang}t(function(){e.$broadcast("editor:entity_loaded",l)},0)},this.setSourceEntity=function(t){t.editorEntityType="exist",e.$broadcast("editor:entity_loaded",t)},this.getEntityType=function(){return r},this.addFieldController=function(e){d.push(e),e.$fieldHash=Math.random().toString(36).substr(2,15)},this.deleteFieldController=function(e){angular.forEach(d,function(t,i){t.$fieldHash===e.$fieldHash&&d.splice(i,1)})},this.setActionType=function(e){this.actionType=e},this.editEntityUpdate=function(t,i){this.setActionType(t);var a={};switch(angular.forEach(d,function(e){e.hasOwnProperty("readonly")&&e.readonly!==!1||angular.merge(a,e.getFieldValue())}),t){case"create":e.$emit("editor:create_entity",[a,i]);break;case"update":e.$emit("editor:update_entity",[a,i])}},this.editEntityPresave=function(t){var i={};angular.forEach(d,function(e){e.hasOwnProperty("readonly")&&e.readonly!==!1||angular.merge(i,e.getFieldValue())}),e.$emit("editor:presave_entity",[i,t])},e.$on("editor:add_entity",function(e,t){o.actionType=t}),e.$on("editor:set_entity_type",function(e,t){r=t,d=[]})}angular.module("universal.editor").service("EditEntityStorage",e),e.$inject=["$rootScope","$timeout","configData","$location","$state","$stateParams"]}(),function(){"use strict";function e(e,t,i){var a,n=[];this.addFilterController=function(e){n.push(e),e.$fieldHash=Math.random().toString(36).substr(2,15)},this.deleteFilterController=function(e){angular.forEach(n,function(t,i){t.$fieldHash===e.$fieldHash&&n.splice(i,1)})},this.getFilterValue=function(){var e={};return angular.forEach(n,function(t,i){t.getFilterValue()&&angular.extend(e,t.getFilterValue())}),e},this.setInitialValues=function(){angular.forEach(n,function(e,t){e.setInitialValue()})},e.$on("editor:set_entity_type",function(e,t){a=t,n=[]})}angular.module("universal.editor").service("FilterFieldsStorage",e),e.$inject=["$rootScope","$timeout","configData"]}(),function(){"use strict";function e(e,t,i,a,n,l,r,d,o,u){var s,c,m,f,p,v,g,h=this;h.isProcessing=!1,h.methodType="",h.editedEntityId=null,t.$on("editor:set_entity_type",function(e,t){m=void 0,s=t,f="items";var i=g[s].choose,n=a.entities.filter(function(e){return e.name===s});n.length>1?n.forEach(function(e){e.lang===i&&(p=e)}):p=n[0],g[s].label=p.label,v=h.getMixModeByEntity(),angular.isDefined(p.backend.keys)&&(f=p.backend.keys.items||f)}),t.$on("editor:create_entity",function(e,t){h.addNewItem(t)}),t.$on("editor:update_entity",function(e,t){h.updateItem(t)}),t.$on("editor:presave_entity",function(e,t){h.presaveItem(t)}),this.getQueryParams=function(){try{return JSON.parse(JSON.stringify(c))}catch(e){return{}}},this.setQueryParams=function(e){c=Object.keys(e).length>0?e:void 0},this.setFilterParams=function(e){m=Object.keys(e).length>0?e:void 0},this.getItemsList=function(a){var n=e.defer();c&&c.hasOwnProperty("filter")&&delete c.filter;var r=this.getQueryParams(),d="GET",o=p.backend.url;if("undefined"!=typeof a&&(r="undefined"!=typeof a.params?a.params:r,d="undefined"!=typeof a.method?a.method:d,o="undefined"!=typeof a.url?a.url:o,void 0!==a.sort&&(r.sort=a.sort)),c=r,!h.isProcessing){if(l.search().hasOwnProperty("parent")){var u={};u[p.backend.fields.parent]=l.search().parent,angular.extend(r,{filter:JSON.stringify(u)})}if(m)if(r.hasOwnProperty("filter")){var s=JSON.parse(r.filter);angular.extend(s,m),r.filter=JSON.stringify(s)}else r.filter=JSON.stringify(m);v.existence&&(r=r||{},angular.extend(r,{mixed:v.entity})),p.backend.hasOwnProperty("parentField")&&(r=r||{},r.hasOwnProperty("filter")||(r.root=!0)),!p.backend.hasOwnProperty("sortBy")||r.hasOwnProperty(p.backend.sortBy)||r.sort||(r=r||{},angular.extend(r,{sort:p.backend.sortBy})),r.hasOwnProperty("filter")&&delete r.root,h.isProcessing=!0;var g=[];return angular.forEach(p.tabs,function(e){angular.forEach(e.fields,function(e){e.hasOwnProperty("expandable")&&e.expandable===!0&&g.push(e.name)})}),g.length>0&&(r.expand=g.join(",")),i({method:d,url:o,params:r}).then(function(e){h.isProcessing=!1,0===e.data[f].length?(t.$broadcast("editor:parent_empty"),t.$broadcast("editor:items_list",e.data),n.resolve()):(t.$broadcast("editor:items_list",e.data),n.resolve())},function(e){h.isProcessing=!1,n.reject()}),n.promise}},this.getItemsListWithParams=function(e){h.isProcessing||(v.existence&&(e=e||{},"object"==typeof e?angular.extend(e,{mixed:v.entity}):e=e+"&mixed="+v.entity),p.backend.fields.parent&&(e=e||{},e.hasOwnProperty("filter")||("object"==typeof e?angular.extend(e,{root:!0}):e+="&root=true")),"object"==typeof e&&(e=o(e)),h.isProcessing=!0,i({method:"GET",url:p.backend.url+"?"+e}).then(function(e){h.isProcessing=!1,t.$broadcast("editor:items_list",e.data),l.search().hasOwnProperty("id")&&h.getItemById(l.search().id)},function(e){h.isProcessing=!1}))},this.getData=function(e,t){return i({method:"GET",url:e,params:t})},this.addNewItem=function(e){var a=e[0],n=e[1];if(!h.isProcessing){var r=p.backend.fields.parent;if(r&&l.search().parent){var o=!u[0].querySelector(".field-wrapper [name='"+r+"']");o&&(a[r]=l.search().parent)}h.isProcessing=!0;var c={},m="POST",f=p.backend.url,v="id",y="lang";p.backend.hasOwnProperty("fields")&&(v=p.backend.fields.primaryKey?p.backend.fields.primaryKey:v,y=p.backend.fields.language?p.backend.fields.language:y),"create"===l.search()["if-not-exist"]&&(a[y]=g[s].choose,a[v]=l.search().uid),"undefined"!=typeof n&&(c="undefined"!=typeof n.params?n.params:c,m="undefined"!=typeof n.method?n.method:m,f="undefined"!=typeof n.url?n.url:f),i({method:m,url:f,data:a,params:c}).then(function(e){h.isProcessing=!1,t.$broadcast("editor:presave_entity_created",e.data[v]),t.$broadcast("uploader:remove_session"),t.$broadcast("editor:entity_success");var i={};l.search().parent&&(i.parent=l.search().parent),l.search().lang&&(i.lang=l.search().lang),d.go("editor.type.list",i,{reload:!0})},function(e){e.data.error&&e.data.hasOwnProperty("data")&&e.data.data.length>0&&angular.forEach(e.data.data,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(i,a){t.$broadcast("editor:api_error_field_"+e.field+"_"+a+"_"+i.field,i.message)}))}),h.isProcessing=!1})}},this.updateItem=function(e){var a=e[0],n=e[1];if(!h.isProcessing){h.isProcessing=!0;var r={},o="POST",u=p.backend.url+"/"+h.editedEntityId;"undefined"!=typeof n&&(r="undefined"!=typeof n.params?n.params:r,o="undefined"!=typeof n.method?n.method:o,u="undefined"!=typeof n.url?n.url:u),i({method:o,url:u,data:a,params:r}).then(function(e){h.isProcessing=!1,t.$broadcast("uploader:remove_session"),t.$broadcast("editor:entity_success");var i={};l.search().parent&&(i.parent=l.search().parent),d.params.back&&(i.type=d.params.back),l.search().lang&&(i.lang=l.search().lang),d.go("editor.type.list",i,{reload:!0})},function(e){e.data.error&&e.data.hasOwnProperty("data")&&e.data.data.length>0&&angular.forEach(e.data.data,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(i,a){t.$broadcast("editor:api_error_field_"+e.field+"_"+a+"_"+i.field,i.message)}))}),h.isProcessing=!1})}},this.presaveItem=function(e){var a,n=e[0],r=e[1];if(!h.isProcessing){h.isProcessing=!0;var o="id",u="lang";p.backend.hasOwnProperty("fields")&&(o=p.backend.fields.primaryKey?p.backend.fields.primaryKey:o,u=p.backend.fields.language?p.backend.fields.language:u),""===h.editedEntityId||l.search().hasOwnProperty("if-not-exist")?(a=p.backend.url,n[u]=g[s].choose,n[o]=h.editedEntityId):a=p.backend.url+"/"+h.editedEntityId;var c={},m="POST",f=a;"undefined"!=typeof r&&(c="undefined"!=typeof r.params?r.params:c,m="undefined"!=typeof r.method?r.method:m,f="undefined"!=typeof r.url?r.url:f),i({method:m,url:f,data:n,params:c}).then(function(e){switch(h.isProcessing=!1,e.statusText){case"OK":t.$broadcast("editor:presave_entity_updated","");break;case"Created":var i={uid:e.data[o]};l.search().lang&&(i.lang=l.search().lang),d.go("editor.type.entity",i,{notify:!1}),t.$broadcast("editor:presave_entity_created",e.data[o])}},function(e){e.data.error&&e.data.hasOwnProperty("data")&&e.data.data.length>0&&angular.forEach(e.data.data,function(e){e.hasOwnProperty("field")&&(t.$broadcast("editor:api_error_field_"+e.field,e.message),e.hasOwnProperty("fields")&&angular.forEach(e.fields,function(i,a){t.$broadcast("editor:api_error_field_"+e.field+"_"+a+"_"+i.field,i.message)}))}),h.isProcessing=!1})}},this.getItemById=function(e,t){var a="undefined"!=typeof t?t:{};if(!h.isProcessing){h.isProcessing=!0;var r=[];angular.forEach(p.tabs,function(e){angular.forEach(e.fields,function(e){e.hasOwnProperty("expand")&&e.expand===!0&&r.push(e.name)})}),r.length>0&&(a.expand=r.join(",")),i({method:"GET",url:p.backend.url+"/"+e,params:a}).then(function(e){h.isProcessing=!1,n.setSourceEntity(e.data)},function(t){if(h.isProcessing=!1,404===t.status&&"create"===l.search()["if-not-exist"]){var i=l.search();angular.merge(i,{uid:e}),n.createNewEntity(i)}})}},this.deleteItemById=function(e,a){var n={};if(!h.isProcessing){h.isProcessing=!0;var r="DELETE",o=p.backend.url+"/"+e;"undefined"!=typeof a&&(n="undefined"!=typeof a.params?a.params:n,r="undefined"!=typeof a.method?a.method:r,o="undefined"!=typeof a.url?a.url:o),i({method:r,url:o,params:n}).then(function(e){h.isProcessing=!1,h.setQueryParams({}),h.setFilterParams({}),t.$broadcast("editor:entity_success_deleted");var i={};l.search().parent&&(i.parent=l.search().parent),d.params.back&&(i.type=d.params.back),l.search().lang&&(i.lang=l.search().lang),d.go("editor.type.list",i,{reload:!0})},function(e){h.isProcessing=!1})}},this.getUrlResource=function y(t,a,n,l,r){function d(e,t){return i({method:"GET",url:e,params:{page:t||1,"per-page":50}})}var o=n||e.defer(),u=a||[],s=[];if(l=l||1,r=r||0,12===l&&(l=11),r)for(var c=l;c<=r;c++)s.push(d(t,c));else s.push(d(t));return e.all(s).then(function(e){for(var i,a,n=e.length;n--;)i=e[n],u=u.concat(i.data.items);return i.data._meta&&(a=i.data._meta.pageCount),a&&a!==r&&1!==a?(l=1===l?2:l+10,r+=10,r>a&&(r=a),y(t,u,o,l,r)):void o.resolve({data:{items:u}})},function(e){}),o.promise},this.contextMenuAction=function(e,t){var a=e.request.params||{},n=e.request.url.replace(":id",t);h.isProcessing=!0,i({method:e.request.method,url:n,params:a}).then(function(e){h.isProcessing=!1,h.getItemsList()},function(e){h.isProcessing=!1})},this.loadChilds=function(e,t){l.search("parent",e),h.getItemsList(t).then(function(t){r(function(){l.search("parent",e)},0)})},this.loadParent=function(e){e="undefined"!=typeof e?e:void 0,e?(h.isProcessing=!0,i({method:"GET",url:p.backend.url+"/"+e}).then(function(e){var t;null!==e.data[p.backend.fields.parent]?(h.isProcessing=!1,t=e.data[p.backend.fields.parent],l.search("parent",t),h.getItemsList()):(h.isProcessing=!1,l.search("parent",null),h.getItemsList())},function(e){h.isProcessing=!1})):(h.isProcessing=!0,l.search("parent",null),h.getItemsList())},this.setEntityType=function(e,t){s=e;var i=a.entities.filter(function(e){return e.name===s});g||(g={},a.entities.forEach(function(e){g.hasOwnProperty(e.name)?g[e.name].langs.push(e.lang):(g[e.name]={},g[e.name].langs=[],g[e.name].label=e.label,e.hasOwnProperty("lang")&&(g[e.name].langs.push(e.lang),g[e.name].choose=e.lang))})),i.length>1?i.forEach(function(e){e.lang===t&&(p=e)}):p=i[0],g[s].choose=t,g[s].label=p.label,v=h.getMixModeByEntity()},this.getMultilanguage=function(){return g},this.getEntityType=function(){return s},this.getEntityObject=function(){return p},this.getMixModeByEntity=function(){var e={};return e.existence=!1,a.hasOwnProperty("mixedMode")&&angular.forEach(a.mixedMode,function(t){t.entities[0]==s&&(e.existence=!0,e.entity=t.entities[1],e.entityTypeName=t.fieldType)}),e}}angular.module("universal.editor").service("RestApiService",e),e.$inject=["$q","$rootScope","$http","configData","EditEntityStorage","$location","$timeout","$state","$httpParamSerializer","$document"]}(),function(){"use strict";function e(e,t,i,a,n){var l=this;l.label=e.buttonLabel,t.bind("click",function(){a.search().hasOwnProperty("id")&&a.search("id",null);var t=""!==a.search().parent?a.search().parent:void 0,i=e.type||n.params.type,l={parent:t,type:i};a.search().lang&&(l.lang=a.search().lang),n.go("editor.type.new",l,{reload:!0})})}angular.module("universal.editor").controller("EditorButtonCreateController",e),e.$inject=["$scope","$element","EditEntityStorage","$location","$state"]}(),function(){"use strict";function e(e,t){function i(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonCreate/editorButtonCreate.html"),scope:{buttonLabel:"@",buttonParams:"@",type:"="},controller:"EditorButtonCreateController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("editorButtonCreate",e),e.$inject=["$templateCache","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonCreate/editorButtonCreate.html",'\n<button class="btn btn-lg btn-success">{{vm.label}}</button>')}])}(),function(){"use strict";function e(e,t,i,a,n){var l=this;l.label=t.buttonLabel,l.processing=n.isProcessing;var r=t.$watch(function(){return n.isProcessing},function(e){l.processing=e});t.$on("$destroy",function(){r()}),i.bind("click",function(){l.processing||a.editEntityUpdate("create")})}angular.module("universal.editor").controller("EditorButtonAddController",e),e.$inject=["$rootScope","$scope","$element","EditEntityStorage","RestApiService"]}(),function(){"use strict";function e(e,t){function i(e,i,a,n){e.editor=t.getEntityType(),i.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonAdd/editorButtonAdd.html"),scope:{entityId:"@",buttonLabel:"@",buttonParams:"@"},controller:"EditorButtonAddController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("editorButtonAdd",e),e.$inject=["$templateCache","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonAdd/editorButtonAdd.html",'\n<button data-ng-class="{ processing : vm.processing}" class="btn btn-md btn-success">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";function e(e,t,i){var a,n,l=this;try{n=JSON.parse(e.buttonRequest),a=n.params}catch(r){}l.buttonClass=e.buttonClass,l.label=e.buttonLabel,l.entityId=e.entityId,l.processing=i.isProcessing;var d=e.$watch("entityId",function(e){l.entityId=e}),o=e.$watch(function(){return i.isProcessing},function(e){l.processing=e});e.$on("$destroy",function(){d(),o()}),t.bind("click",function(){l.processing||confirm("Удалить запись «"+l.entityId+"»?")&&i.deleteItemById(l.entityId,n)})}angular.module("universal.editor").controller("EditorButtonDeleteController",e),e.$inject=["$scope","$element","RestApiService"]}(),function(){"use strict";function e(e,t){function i(e,i,a,n){e.editor=t.getEntityType(),i.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonDelete/editorButtonDelete.html"),scope:{entityId:"@",buttonLabel:"@",buttonRequest:"@",entityName:"@",buttonClass:"@"},controller:"EditorButtonDeleteController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("editorButtonDelete",e),e.$inject=["$templateCache","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonDelete/editorButtonDelete.html",'\n<div>\n    <button data-ng-class="{ processing : vm.processing}" data-ng-if="vm.buttonClass == \'editor\'" class="btn btn-md btn-success">{{vm.label}}\n        <div data-ng-show="vm.processing" class="loader-search-wrapper">\n            <div class="loader-search">{{\'LOADING\' | translate}}</div>\n        </div>\n    </button>\n    <button data-ng-if="vm.buttonClass == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a,n,l){var r,d=this;try{r=JSON.parse(t.buttonRequest)}catch(o){}d.label=t.buttonLabel,d["class"]=t.buttonClass,i.bind("click",function(){var e=r.url;for(var i in t.itemValue)t.itemValue[i]&&(e=e.replace(":"+i,t.itemValue[i]));location.assign(e)})}angular.module("universal.editor").controller("EditorButtonDownloadController",e),e.$inject=["$rootScope","$scope","$element","RestApiService","configData","$window"]}(),function(){"use strict";function e(e,t,i){function a(e,i,a,n){e.editor=t.getEntityType(),i.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonDownload/editorButtonDownload.html"),scope:{itemValue:"=",buttonLabel:"@",buttonRequest:"@",index:"@",buttonClass:"@"},controller:"EditorButtonDownloadController",controllerAs:"vm",link:a}}angular.module("universal.editor").directive("editorButtonDownload",e),e.$inject=["$templateCache","RestApiService","configData"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonDownload/editorButtonDownload.html",'\n<div>\n    <button data-ng-if="vm.class == \'editor\'" class="btn btn-md btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.class == \'header\'" class="btn btn-lg btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.class == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a,n){var l,r,d=this;try{r=JSON.parse(e.buttonRequest),l=r.params}catch(o){}d.processing=i.isProcessing;var u=e.$watch(function(){return i.isProcessing},function(e){d.processing=e});e.$on("$destroy",function(){u()}),d.label=e.buttonLabel,t.bind("click",function(){if(!d.processing){var t={uid:e.entityId},i={};e.entitySubtype?(t.type=e.entitySubtype,t.back=a.params.type,i.reload=!0):t.type=a.params.type,n.search().parent&&(t.parent=n.search().parent),n.search().lang&&(t.lang=n.search().lang),a.go("editor.type.entity",t,i)}})}angular.module("universal.editor").controller("EditorButtonEditController",e),e.$inject=["$scope","$element","RestApiService","$state","$location"]}(),function(){"use strict";function e(e,t){function i(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonEdit/editorButtonEdit.html"),scope:{entityId:"@",buttonLabel:"@",buttonRequest:"@",entitySubtype:"@"},controller:"EditorButtonEditController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("editorButtonEdit",e),e.$inject=["$templateCache","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonEdit/editorButtonEdit.html",'\n<button data-ng-class="{ processing : vm.processing}" class="editor-action-button">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";function e(e,t,i,a){var n,l,r=this;try{l=JSON.parse(t.buttonRequest),n=l.params}catch(d){}r.label=t.buttonLabel,r.processing=a.isProcessing;var o=t.$watch(function(){return a.isProcessing},function(e){r.processing=e});t.$on("$destroy",function(){o()}),i.bind("click",function(){r.processing||a.loadChilds(t.entityId,l)})}angular.module("universal.editor").controller("EditorButtonOpenController",e),e.$inject=["$rootScope","$scope","$element","RestApiService"]}(),function(){"use strict";function e(e,t){function i(e,i,a,n){e.editor=t.getEntityType(),i.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonOpen/editorButtonOpen.html"),scope:{entityId:"@",buttonLabel:"@",buttonRequest:"@"},controller:"EditorButtonOpenController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("editorButtonOpen",e),e.$inject=["$templateCache","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonOpen/editorButtonOpen.html",'\n<button data-ng-class="{ processing : vm.processing}" class="editor-action-button">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";function e(e,t,i,a,n){var l,r,d=this;try{r=JSON.parse(e.buttonRequest),l=r.params}catch(o){}d.label=e.buttonLabel,d.entityId=e.entityId,d.processing=n.isProcessing;var u=e.$watch("entityId",function(e){d.entityId=e}),s=e.$watch(function(){return n.isProcessing},function(e){d.processing=e});e.$on("$destroy",function(){u(),s()}),t.bind("click",function(){d.processing||(n.editedEntityId=d.entityId,a.editEntityPresave(r))})}angular.module("universal.editor").controller("EditorButtonPresaveController",e),e.$inject=["$scope","$element","$rootScope","EditEntityStorage","RestApiService"]}(),function(){"use strict";function e(e,t){function i(e,i,a,n){e.editor=t.getEntityType(),i.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonPresave/editorButtonPresave.html"),scope:{entityId:"@",buttonLabel:"@",buttonRequest:"@"},controller:"EditorButtonPresaveController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("editorButtonPresave",e),e.$inject=["$templateCache","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonPresave/editorButtonPresave.html",'\n<button data-ng-class="{ processing : vm.processing}" class="btn btn-md btn-success">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";function e(e,t,i,a,n,l){var r,d=this;try{r=JSON.parse(t.buttonRequest)}catch(o){}d["class"]=t.buttonClass,d.label=t.buttonLabel,i.bind("click",function(){var e=r.url;for(var i in t.itemValue)t.itemValue[i]&&(e=e.replace(":"+i,t.itemValue[i]));window.open(e,"_blank")})}angular.module("universal.editor").controller("EditorButtonTargetBlankController",e),e.$inject=["$rootScope","$scope","$element","RestApiService","configData","$http"]}(),function(){"use strict";function e(e,t,i){function a(e,i,a,n){e.editor=t.getEntityType(),i.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonTargetBlank/editorButtonTargetBlank.html"),scope:{itemValue:"=",buttonLabel:"@",buttonRequest:"@",index:"@",buttonClass:"@"},controller:"EditorButtonTargetBlankController",controllerAs:"vm",link:a}}angular.module("universal.editor").directive("editorButtonTargetBlank",e),e.$inject=["$templateCache","RestApiService","configData"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonTargetBlank/editorButtonTargetBlank.html",'\n<div>\n    <button data-ng-if="vm.class == \'editor\'" class="btn btn-md btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.class == \'header\'" class="btn btn-lg btn-success">{{vm.label}}</button>\n    <button data-ng-if="vm.class == \'context\'" class="editor-action-button">{{vm.label}}</button>\n</div>');
}])}(),function(){"use strict";function e(e,t,i,a,n){var l=this;l.label=e.buttonLabel,l.entityId=e.entityId,l.processing=n.isProcessing;var r=e.$watch("entityId",function(e){l.entityId=e}),d=e.$watch(function(){return n.isProcessing},function(e){l.processing=e});e.$on("$destroy",function(){r(),d()}),t.bind("click",function(){l.processing||(n.editedEntityId=l.entityId,a.editEntityUpdate("update"))})}angular.module("universal.editor").controller("EditorButtonUpdateController",e),e.$inject=["$scope","$element","$rootScope","EditEntityStorage","RestApiService"]}(),function(){"use strict";function e(e,t){function i(e,i,a,n){e.editor=t.getEntityType(),i.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,template:e.get("module/directives/editorButtonUpdate/editorButtonUpdate.html"),scope:{entityId:"@",buttonLabel:"@",buttonParams:"@"},controller:"EditorButtonUpdateController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("editorButtonUpdate",e),e.$inject=["$templateCache","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorButtonUpdate/editorButtonUpdate.html",'\n<button data-ng-class="{ processing : vm.processing}" class="btn btn-md btn-success">{{vm.label}}\n    <div data-ng-show="vm.processing" class="loader-search-wrapper">\n        <div class="loader-search">{{\'LOADING\' | translate}}</div>\n    </div>\n</button>')}])}(),function(){"use strict";function e(e,t,i,a,n,l){var r,d=this;r=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,d.fieldName=e.field.name,d.fieldDisplayName=e.field.label,d.hint=e.field.hint||!1,d.innerFields=e.field.fields,d.fieldsArray=[],d.multiple=e.field.hasOwnProperty("multiple")&&e.field.multiple===!0,a.addFieldController(this),this.getFieldValue=function(){var e={};return e[d.fieldName]=d.fieldsArray.length>0?[]:"",e},this.getInitialValue=function(){var e={};return e[d.fieldName]=[],e},e.$on("editor:entity_loaded",function(t,i){d.multiple&&("new"===i.editorEntityType?(d.fieldsArray=[],l.setArrayField(d.fieldName,[])):(l.setArrayField(d.fieldName,JSON.parse(JSON.stringify(i[e.field.name]))),d.fieldsArray=i[e.field.name]))}),e.$on("editor:api_error_field_"+r,function(e,t){angular.isArray(t)?angular.forEach(t,function(e){d.error.indexOf(e)<0&&d.error.push(e)}):d.error.indexOf(t)<0&&d.error.push(t)}),d.removeItem=function(e){var t=d.fieldsArray;d.fieldsArray=[],n(function(){l.removeFieldIndex(d.fieldName,e),t.splice(e,1),d.fieldsArray=t},0)},d.addItem=function(){d.fieldsArray.push("")}}angular.module("universal.editor").controller("EditorFieldArrayController",e),e.$inject=["$scope","$rootScope","configData","EditEntityStorage","$timeout","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,transclude:!0,template:e.get("module/directives/editorFieldArray/editorFieldArray.html"),controller:"EditorFieldArrayController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldArray",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldArray/editorFieldArray.html",'\n<div class="editor-field-array">\n    <div class="field-name-label label-array">\n        <div data-ng-if="vm.hint" class="field-hint">\n            <div class="hint-text">{{vm.hint}}</div>\n        </div>{{vm.fieldDisplayName}}\n    </div>\n    <div class="field-array-wrapper">\n        <div data-ng-if="vm.multiple">\n            <div data-ng-repeat="array in vm.fieldsArray track by $index" data-ng-init="outerIndex = $index" class="item-array-wrapper">\n                <div data-ng-repeat="field in vm.innerFields" data-field-wrapper="" data-field-name="{{field.name}}" data-parent-field="{{vm.fieldName}}" data-parent-field-index="{{outerIndex}}"></div>\n                <div class="row">\n                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6">\n                        <div data-ng-click="vm.removeItem(outerIndex)" data-ng-if="!vm.readonly" class="btn btn-primary btn-xs">{{\'BUTTON.DELETE\' | translate}}</div>\n                    </div>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 col-lg-offset-6 col-md-offset-6 col-sm-offset-6 col-xs-offset-6">\n                    <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n                </div>\n            </div>\n        </div>\n        <div data-ng-if="!vm.multiple">\n            <div data-ng-repeat="field in vm.innerFields" data-field-wrapper="" data-field-name="{{field.name}}" data-parent-field="{{vm.fieldName}}"></div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a,n,l){function r(){e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?p.fieldValue=[]:p.fieldValue=void 0,p.inputValue="",p.selectedValues=[]}function d(t){if(e.$parent.vm.error=[],!(""===t||t.length<=p.minCount))if(p.searching=!0,e.field.hasOwnProperty("values"))angular.forEach(e.field.values,function(e,i){var a={};o(e,t)&&!s(e)&&(a[p.field_id]=i,a[p.field_search]=e,p.possibleValues.push(a))}),p.activeElement=0,p.searching=!1;else{var i={};i[p.field_search]="%"+t+"%",a.getUrlResource(e.field.valuesRemote.url+"?filter="+JSON.stringify(i)).then(function(e){angular.forEach(e.data.items,function(e){s(e)||u(e)||p.possibleValues.push(e)}),p.activeElement=0,p.searching=!1},function(t){console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+e.field.name+'" с удаленного ресурса'),p.searching=!1})}}function o(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>=0}function u(e){var t=!1;return angular.forEach(p.possibleValues,function(i){i[p.field_id]==e[p.field_id]&&(t=!0)}),t}function s(e){var t=!1;return angular.forEach(p.selectedValues,function(i){i[p.field_id]==e[p.field_id]&&(t=!0)}),t}function c(){if(e.field.hasOwnProperty("values"))angular.forEach(e.field.values,function(e,t){var i={};Array.isArray(p.fieldValue)&&p.fieldValue.indexOf(t)>=0&&p.multiple?(i[p.field_id]=t,i[p.field_search]=e,p.selectedValues.push(i)):p.fieldValue!=t||p.multiple||(i[p.field_id]=t,i[p.field_search]=e,p.selectedValues.push(i))}),p.preloadedData=!0;else if(e.field.hasOwnProperty("valuesRemote")){if(void 0===p.fieldValue||null===p.fieldValue)return void(p.preloadedData=!0);var t;if(p.multiple&&angular.isArray(p.fieldValue)&&p.fieldValue.length>0)t={},t[p.field_id]=p.fieldValue;else{if(p.multiple||""===p.fieldValue)return void(p.preloadedData=!0);t={},t[p.field_id]=[],t[p.field_id].push(p.fieldValue)}a.getUrlResource(e.field.valuesRemote.url+"?filter="+JSON.stringify(t)).then(function(e){angular.forEach(e.data.items,function(e){Array.isArray(p.fieldValue)&&(p.fieldValue.indexOf(e[p.field_id])>=0||p.fieldValue.indexOf(String(e[p.field_id]))>=0)&&p.multiple?p.selectedValues.push(e):p.fieldValue!=e[p.field_id]||p.multiple||p.selectedValues.push(e)}),p.preloadedData=!0},function(t){p.preloadedData=!0,console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+e.field.name+'" с удаленного ресурса')})}else p.preloadedData=!0,console.error("EditorFieldAutocompleteController: Для поля не указан ни один тип получения значений ( локальный или удаленный )")}var m,f,p=this;f=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName;var v=angular.element(t[0].getElementsByClassName("possible-values")[0]),g=e.field.valuesRemote;p.field_id="id",p.field_search="title",g&&g.fields&&(g.fields.value&&(p.field_id=g.fields.value),g.fields.label&&(p.field_search=g.fields.label)),p.fieldName=e.field.name,p.readonly=e.field.readonly||!1,e.$parent.vm.error=[],p.selectedValues=[],p.inputValue="",p.possibleValues=[],p.activeElement=0,p.preloadedData=!1,p.parentFieldIndex=e.parentFieldIndex||!1,p.searching=!1,p.maxItemsCount=e.field.maxItems||Number.POSITIVE_INFINITY,p.minCount=e.field.minCount||2,e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(p.multiple=!0,p.fieldValue=[],(e.field.multiname||angular.isString(e.field.multiname))&&(p.multiname=""+e.field.multiname||"value")):(p.multiple=!1,p.fieldValue=void 0),p.parentFieldIndex&&(p.multiple?(p.fieldValue=[],angular.forEach(l.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){p.multiname?p.fieldValue.push(e[p.multiname]):p.fieldValue.push(e)})):p.fieldValue=l.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name)||p.fieldValue,p.preloadedData=!1,c()),i.addFieldController(this),t.find("input").bind("keydown",function(e){switch(e.which){case 13:if(e.preventDefault(),p.possibleValues.length<1)break;n(function(){p.addToSelected(p.possibleValues[p.activeElement])},0);break;case 40:if(e.preventDefault(),p.possibleValues.length<1)break;p.activeElement<p.possibleValues.length-1&&(n(function(){p.activeElement++},0),n(function(){var e=angular.element(v[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(v[0].getElementsByClassName("active")[0])[0].clientHeight,i=v[0].scrollTop,a=v[0].clientHeight;e>=a+i&&(v[0].scrollTop+=t+1)},1));break;case 38:if(e.preventDefault(),p.possibleValues.length<1)break;p.activeElement>0&&(n(function(){p.activeElement--},0),n(function(){var e=angular.element(v[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(v[0].getElementsByClassName("active")[0])[0].clientHeight,i=v[0].scrollTop;v[0].clientHeight;e<i&&(v[0].scrollTop-=t+1)},1))}}),this.getFieldValue=function(){var t,i={};return p.multiname?(t=[],angular.forEach(p.selectedValues,function(e){var i={};i[p.multiname]=e[p.field_id],t.push(i)})):p.multiple?(t=[],angular.forEach(p.selectedValues,function(e){t.push(e[p.field_id])})):t=p.selectedValues.length>0?p.selectedValues[0][p.field_id]:"",e.parentField?p.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][p.parentFieldIndex]={},i[e.parentField][p.parentFieldIndex][p.fieldName]=t):(i[e.parentField]={},i[e.parentField][p.fieldName]=t):i[p.fieldName]=t,i},this.getInitialValue=function(){var t={};return e.parentField?p.multiple?(t[e.parentField]={},t[e.parentField][p.fieldName]=[]):(t[e.parentField]={},t[e.parentField][p.fieldName]=void 0):p.multiple?t[p.fieldName]=[]:t[p.fieldName]=void 0,t},e.$on("editor:entity_loaded",function(t,a){return p.preloadedData=!1,p.inputValue="",p.selectedValues=[],e.field.requiredField&&e.$watch(function(){var t=i.getValueField(e.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(t),a},function(t){t?p.readonly=e.field.readonly||!1:(r(),p.readonly=!0)},!0),"new"===a.editorEntityType?(p.fieldValue=p.multiple?[]:void 0,a.hasOwnProperty(e.fieldName)&&(p.fieldValue=a[e.fieldName],c()),void(p.preloadedData=!0)):(e.parentField?p.multiple?p.multiname?(p.fieldValue=[],angular.forEach(a[e.parentField][e.field.name],function(e){p.fieldValue.push(e[p.multiname])})):(p.fieldValue=[],angular.forEach(a[e.parentField][e.field.name],function(e){p.fieldValue.push(e)})):p.fieldValue=a[e.parentField][e.field.name]:p.multiple?p.multiname?(p.fieldValue=[],angular.forEach(a[e.field.name],function(e){p.fieldValue.push(e[p.multiname])})):(p.fieldValue=[],angular.forEach(a[e.field.name],function(e){p.fieldValue.push(e)})):p.fieldValue=a[e.field.name],void c())}),e.$on("$destroy",function(){i.deleteFieldController(p),p.parentFieldIndex&&l.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,p.fieldValue)}),e.$on("editor:api_error_field_"+f,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$watch(function(){return p.inputValue},function(e){m&&n.cancel(m),p.possibleValues=[],m=n(function(){d(e)},300)},!0),e.$watch(function(){return p.fieldValue},function(){e.$parent.vm.error=[]}),p.addToSelected=function(e){p.selectedValues.push(e),p.inputValue="",p.possibleValues=[]},p.removeFromSelected=function(e){angular.forEach(p.selectedValues,function(t,i){t[p.field_id]==e[p.field_id]&&p.selectedValues.splice(i,1)})}}angular.module("universal.editor").controller("EditorFieldAutocompleteController",e),e.$inject=["$scope","$element","EditEntityStorage","RestApiService","$timeout","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldAutocomplete/editorFieldAutocomplete.html"),controller:"EditorFieldAutocompleteController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldAutocomplete",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldAutocomplete/editorFieldAutocomplete.html",'\n<div>\n    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <div data-ng-show="vm.preloadedData" class="selected-values">\n            <div data-ng-repeat="acItem in vm.selectedValues" class="autocomplete-item">{{acItem[vm.field_search]}}<span data-ng-click="vm.removeFromSelected(acItem)" data-ng-if="!vm.readonly" class="remove-from-selected">×</span></div>\n        </div>\n        <div data-ng-show="vm.preloadedData &amp;&amp; vm.selectedValues.length &lt; vm.maxItemsCount" class="autocomplete-input-wrapper">\n            <input type="text" data-ng-hide="(!vm.multiple &amp;&amp; vm.selectedValues.length &gt;= 1)" ng-disabled="vm.readonly" data-ng-model="vm.inputValue" class="form-control input-sm"/>\n            <div data-ng-show="vm.searching" class="loader-search-wrapper">\n                <div class="loader-search">{{\'LOADING\' | translate}}</div>\n            </div>\n            <div data-ng-if="!vm.readonly &amp;&amp; (vm.possibleValues.length &gt; 0)" class="possible-values">\n                <div data-ng-repeat="possible in vm.possibleValues" data-ng-mouseover="vm.activeElement = $index" data-ng-click="vm.addToSelected(possible)" data-ng-class="vm.activeElement == $index ? \'active\' : \'\'" class="possible-value-item">{{possible[vm.field_search]}}</div>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a){function n(){r.fieldValue=r.parentFieldIndex?[]:void 0}var l,r=this;l=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName;var d=e.field.valuesRemote;if(r.field_id="id",r.field_search="title",d&&d.fields&&(d.fields.value&&(r.field_id=d.fields.value),d.fields.label&&(r.field_search=d.fields.label)),r.fieldName=e.field.name,r.selectedValues=[],r.inputValue="",r.readonly=e.field.readonly||!1,e.$parent.vm.error=[],r.parentFieldIndex=e.parentFieldIndex||!1,(e.field.multiname||angular.isString(e.field.multiname))&&(r.multiname=""+e.field.multiname||"value"),t.addFieldController(this),r.parentFieldIndex){r.fieldValue=[];var o=a.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name);o&&(angular.isArray(o)?angular.forEach(o,function(e){r.multiname?r.fieldValue.push(e[r.multiname]):r.fieldValue.push(e)}):r.multiname?r.fieldValue.push(o[r.multiname]):r.fieldValue.push(o))}e.field.hasOwnProperty("values")?angular.forEach(e.field.values,function(e,t){var i={};i[r.field_id]=t,i[r.field_search]=e,r.selectedValues.push(i)}):e.field.hasOwnProperty("valuesRemote")?i.getUrlResource(e.field.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){r.selectedValues.push(e)})},function(t){console.error('EditorFieldCheckboxController: Не удалось получить значения для поля "'+e.field.fieldName+'" с удаленного ресурса')}):console.error("EditorFieldCheckboxController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFieldValue=function(){var t,i={};if(r.selectedValues.length&&1===r.selectedValues.length)if(t="",angular.isUndefined(r.fieldValue)&&(r.fieldValue=[]),r.multiname){var a={};a[r.multiname]=r.fieldValue[0],t=a}else t=r.fieldValue[0];else r.selectedValues.length&&r.selectedValues.length>1&&(t=[],r.multiname?angular.forEach(r.fieldValue,function(e){var i={};i[r.multiname]=e,t.push(i)}):angular.forEach(r.fieldValue,function(e){t.push(e)}));return e.parentField?r.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][r.parentFieldIndex]={},i[e.parentField][r.parentFieldIndex][r.fieldName]=t):(i[e.parentField]={},i[e.parentField][r.fieldName]=t):i[r.fieldName]=t,i},this.getInitialValue=function(){var t={};return e.parentField?(t[e.parentField]={},t[e.parentField][r.fieldName]=[]):t[r.fieldName]=[],t},e.$on("editor:entity_loaded",function(i,a){e.field.requiredField&&e.$watch(function(){var i=t.getValueField(e.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(i),a},function(t){t?r.readonly=e.field.readonly||!1:(n(),r.readonly=!0)},!0),"new"!==a.editorEntityType&&(e.parentField?(r.fieldValue=[],a[e.field.name]&&(angular.isArray(a[e.parentField][e.field.name])?angular.forEach(a[e.parentField][e.field.name],function(e){r.multiname?r.fieldValue.push(e[r.multiname]):r.fieldValue.push(e)}):r.multiname?r.fieldValue.push(a[e.parentField][e.field.name][r.multiname]):r.fieldValue.push(a[e.parentField][e.field.name]))):(r.fieldValue=[],a[e.field.name]&&(angular.isArray(a[e.field.name])?angular.forEach(a[e.field.name],function(e){r.multiname?r.fieldValue.push(e[r.multiname]):r.fieldValue.push(e)}):r.multiname?r.fieldValue.push(a[e.field.name][r.multiname]):r.fieldValue.push(a[e.field.name]))))}),e.$on("$destroy",function(){t.deleteFieldController(r),r.parentFieldIndex&&a.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,r.fieldValue)}),e.$on("editor:api_error_field_"+l,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$watch(function(){return r.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("universal.editor").controller("EditorFieldCheckboxController",e),e.$inject=["$scope","EditEntityStorage","RestApiService","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldCheckbox/editorFieldCheckbox.html"),controller:"EditorFieldCheckboxController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldCheckbox",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldCheckbox/editorFieldCheckbox.html",'\n<div>\n    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <div data-ng-repeat="item in vm.selectedValues" data-ng-class="vm.readonly ? \'disabled\' : \'\'" class="checkbox">\n            <label>\n                <input type="checkbox" data-ng-disabled="vm.readonly" data-checklist-model="vm.fieldValue" data-checklist-value="item[vm.field_id]"/>{{item[vm.field_search]}}\n            </label>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){var a,n=this,l="#000000";a=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,n.fieldName=e.field.name,n.readonly=e.field.readonly||!1,e.$parent.vm.error=[],n.parentFieldIndex=e.parentFieldIndex||!1,e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(n.multiple=!0,n.fieldValue=[l],(e.field.multiname||angular.isString(e.field.multiname))&&(n.multiname=""+e.field.multiname||"value")):(n.multiple=!1,n.fieldValue=l),n.parentFieldIndex&&(n.multiple?(n.fieldValue=[],angular.forEach(i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){n.multiname?n.fieldValue.push(e[n.multiname]):n.fieldValue.push(e)})):n.fieldValue=i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name)||""),t.addFieldController(this),this.getFieldValue=function(){var t,i={};return n.multiname?(t=[],angular.forEach(n.fieldValue,function(e){var i={};i[n.multiname]=e,t.push(i)})):n.multiple?(t=[],angular.forEach(n.fieldValue,function(e){t.push(e)})):t=n.fieldValue,e.parentField?n.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][n.parentFieldIndex]={},i[e.parentField][n.parentFieldIndex][n.fieldName]=t):(i[e.parentField]={},i[e.parentField][n.fieldName]=t):i[n.fieldName]=t,i},this.getInitialValue=function(){var t={};return e.parentField?n.multiple?(t[e.parentField]={},t[e.parentField][n.fieldName]=[l]):(t[e.parentField]={},t[e.parentField][n.fieldName]=l):n.multiple?t[n.fieldName]=[]:t[n.fieldName]=l,t},n.addItem=function(){n.fieldValue.push(l)},n.removeItem=function(e){angular.forEach(n.fieldValue,function(t,i){i==e&&n.fieldValue.splice(e,1)})},e.$on("editor:entity_loaded",function(t,i){return"new"===i.editorEntityType?void(n.fieldValue=n.multiple?[l]:l):void(e.parentField?n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(i[e.parentField][e.field.name],function(e){n.fieldValue.push(e[n.multiname])})):(n.fieldValue=[],angular.forEach(i[e.parentField][e.field.name],function(e){n.fieldValue.push(e)})):n.fieldValue=i[e.parentField][e.field.name]:n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(i[e.field.name],function(e){n.fieldValue.push(e[n.multiname])})):(n.fieldValue=[],angular.forEach(i[e.field.name],function(e){n.fieldValue.push(e)})):n.fieldValue=i[e.field.name])}),e.$on("editor:api_error_field_"+a,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$on("$destroy",function(){t.deleteFieldController(n),n.parentFieldIndex&&i.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,n.fieldValue)}),e.$watch(function(){return n.fieldValue},function(){e.$parent.vm.error=[]})}angular.module("universal.editor").controller("EditorFieldColorpickerController",e),e.$inject=["$scope","EditEntityStorage","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldColorpicker/editorFieldColorpicker.html"),controller:"EditorFieldColorpickerController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldColorpicker",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldColorpicker/editorFieldColorpicker.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-colorpicker-wrapper input-group">\n            <input type="text" data-ng-disabled="vm.readonly" data-minicolors="" data-ng-model="vm.fieldValue[$index]" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <input type="text" data-ng-disabled="vm.readonly" data-minicolors="" data-ng-model="vm.fieldValue" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a){function n(){r.fieldValue=e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?[]:""}var l,r=this;if(l=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,r.fieldName=e.field.name,r.fieldValue="",r.readonly=e.field.readonly||!1,e.$parent.vm.error=[],r.parentFieldIndex=e.parentFieldIndex||!1,e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(r.multiple=!0,r.fieldValue=[],(e.field.multiname||angular.isString(e.field.multiname))&&(r.multiname=""+e.field.multiname||"value")):(r.multiple=!1,r.fieldValue=""),r.parentFieldIndex)if(r.multiple)r.fieldValue=[],angular.forEach(a.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){r.multiname?r.fieldValue.push(e[r.multiname]?i(e[r.multiname],"YYYY-MM-DD HH:mm:ss"):""):r.fieldValue.push(e?i(e,"YYYY-MM-DD HH:mm:ss"):"")});else{var d=a.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name);r.fieldValue=d?i(d,"YYYY-MM-DD HH:mm:ss"):r.fieldValue}t.addFieldController(this),this.getFieldValue=function(){var t,a={};return r.multiname?(t=[],angular.forEach(r.fieldValue,function(e){if(e&&""!==e&&i.isMoment(e)){var a={};a[r.multiname]=i(e).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"),t.push(a)}})):r.multiple?(t=[],angular.forEach(r.fieldValue,function(e){t.push(i(e).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"))})):t=void 0!==r.fieldValue&&""!==r.fieldValue&&i.isMoment(r.fieldValue)?i(r.fieldValue).set({second:0,minute:0,hour:0}).format("YYYY-MM-DD HH:mm:ss"):"",e.parentField?r.parentFieldIndex?(a[e.parentField]=[],a[e.parentField][r.parentFieldIndex]={},a[e.parentField][r.parentFieldIndex][r.fieldName]=t):(a[e.parentField]={},a[e.parentField][r.fieldName]=t):a[r.fieldName]=t,a},this.getInitialValue=function(){var t={};return e.parentField?r.multiple?(t[e.parentField]={},t[e.parentField][r.fieldName]=[]):(t[e.parentField]={},t[e.parentField][r.fieldName]=i()):r.multiple?t[r.fieldName]=[]:t[r.fieldName]=i(),t},r.addItem=function(){r.fieldValue.push(i())},r.removeItem=function(e){angular.forEach(r.fieldValue,function(t,i){i==e&&r.fieldValue.splice(e,1)})},e.$on("editor:entity_loaded",function(a,l){return e.field.requiredField&&e.$watch(function(){var i=t.getValueField(e.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(i),a},function(t){t?r.readonly=e.field.readonly||!1:(n(),r.readonly=!0)},!0),"new"===l.editorEntityType?void(r.fieldValue=r.multiple?[]:i()):void(e.parentField?r.multiple?r.multiname?(r.fieldValue=[],angular.forEach(l[e.parentField][e.field.name],function(e){r.fieldValue.push(i(e[r.multiname],"YYYY-MM-DD HH:mm:ss"))})):(r.fieldValue=[],angular.forEach(l[e.parentField][e.field.name],function(e){r.fieldValue.push(i(e,"YYYY-MM-DD HH:mm:ss"))})):r.fieldValue=l[e.parentField][e.field.name]?i(l[e.parentField][e.field.name],"YYYY-MM-DD HH:mm:ss"):"":r.multiple?r.multiname?(r.fieldValue=[],angular.forEach(l[e.field.name],function(e){r.fieldValue.push(i(e[r.multiname],"YYYY-MM-DD HH:mm:ss"))})):(r.fieldValue=[],angular.forEach(l[e.field.name],function(e){r.fieldValue.push(i(e,"YYYY-MM-DD HH:mm:ss"))})):r.fieldValue=l[e.field.name]?i(l[e.field.name],"YYYY-MM-DD HH:mm:ss"):"")}),e.$on("$destroy",function(){t.deleteFieldController(r),r.parentFieldIndex&&a.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,r.fieldValue)}),e.$on("editor:api_error_field_"+l,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$watch(function(){return r.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("universal.editor").controller("EditorFieldDateController",e),e.$inject=["$scope","EditEntityStorage","moment","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldDate/editorFieldDate.html"),controller:"EditorFieldDateController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldDate",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldDate/editorFieldDate.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-datepicker-wrapper input-group">\n            <input data-date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-format="DD.MM.YYYY" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly || !vm.emptyRequiredField" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <input data-date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-format="DD.MM.YYYY" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a){function n(){r.fieldValue=e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?[]:""}var l,r=this;l=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,r.fieldName=e.field.name,r.fieldValue="",r.readonly=e.field.readonly||!1,e.$parent.vm.error=[],r.parentFieldIndex=e.parentFieldIndex||!1,r.multiname=e.field.multiname||"value",e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(r.multiple=!0,r.fieldValue=[]):(r.multiple=!1,r.fieldValue=i.utc()),r.parentFieldIndex&&(r.multiple?(r.fieldValue=[],angular.forEach(a.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){r.fieldValue.push(e[r.multiname])})):r.fieldValue=a.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name)||r.fieldValue),t.addFieldController(this),this.getFieldValue=function(){var t,a={};return r.multiple&&r.multiname?(t=[],angular.forEach(r.fieldValue,function(e){if(e&&""!==e&&i.isMoment(e)){var a={};a[r.multiname]=i.utc(e).format("YYYY-MM-DD HH:mm:ss"),t.push(a)}})):t=void 0!==r.fieldValue&&""!==r.fieldValue&&i.isMoment(r.fieldValue)?i.utc(r.fieldValue).format("YYYY-MM-DD HH:mm:ss"):"",e.parentField?r.parentFieldIndex?(a[e.parentField]=[],a[e.parentField][r.parentFieldIndex]={},a[e.parentField][r.parentFieldIndex][r.fieldName]=t):(a[e.parentField]={},a[e.parentField][r.fieldName]=t):a[r.fieldName]=t,a},this.getInitialValue=function(){var t={};return e.parentField?r.multiple?(t[e.parentField]={},t[e.parentField][r.fieldName]=[]):(t[e.parentField]={},t[e.parentField][r.fieldName]=i.utc()):r.multiple?t[r.fieldName]=[]:t[r.fieldName]=i.utc(),
t},r.addItem=function(){r.fieldValue.push(i.utc())},r.removeItem=function(e){angular.forEach(r.fieldValue,function(t,i){i==e&&r.fieldValue.splice(e,1)})},e.$on("editor:entity_loaded",function(a,l){return e.field.requiredField&&e.$watch(function(){var i=t.getValueField(e.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(i),a},function(t){t?r.readonly=e.field.readonly||!1:(n(),r.readonly=!0)},!0),"new"===l.editorEntityType?void(r.fieldValue=r.multiple?[]:i.utc()):void(e.parentField?r.multiple?(r.fieldValue=[],angular.forEach(l[e.parentField][e.field.name],function(e){r.fieldValue.push(i.utc(e[r.multiname],"YYYY-MM-DD HH:mm:ss"))})):r.fieldValue=null!==l[e.field.name]?i.utc(l[e.field.name],"YYYY-MM-DD HH:mm:ss"):"":r.multiple?(r.fieldValue=[],angular.forEach(l[e.field.name],function(e){r.fieldValue.push(i.utc(e[r.multiname],"YYYY-MM-DD HH:mm:ss"))})):r.fieldValue=null!==l[e.field.name]?i.utc(l[e.field.name]):"")}),e.$on("$destroy",function(){t.deleteFieldController(r),r.parentFieldIndex&&a.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,r.fieldValue)}),e.$on("editor:api_error_field_"+l,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$watch(function(){return r.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("universal.editor").controller("EditorFieldDatetimeController",e),e.$inject=["$scope","EditEntityStorage","moment","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldDatetime/editorFieldDatetime.html"),controller:"EditorFieldDatetimeController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldDatetime",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldDatetime/editorFieldDatetime.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-datepicker-wrapper input-group">\n            <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.fieldValue[$index]" view="date" timezone="UTC" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.fieldValue" view="date" timezone="UTC" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){var a,n=this;a=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,n.fieldName=e.field.name,n.fieldValue="",n.readonly=e.field.readonly||!1,e.$parent.vm.error=[],n.parentFieldIndex=e.parentFieldIndex||!1,n.map=void 0,n.mapParam={height:e.field.mapHeight||"400",width:e.field.mapWidth||"400",center:e.field.mapCenter||[37.620393,55.765575],zoom:e.field.mapZoom||5},e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(n.multiple=!0,n.fieldValue=[],(e.field.multiname||angular.isString(e.field.multiname))&&(n.multiname=""+e.field.multiname||"value")):(n.multiple=!1,n.fieldValue=""),n.parentFieldIndex&&(n.multiple?(n.fieldValue=[],angular.forEach(i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){n.multiname?n.fieldValue.push(e[n.multiname]):n.fieldValue.push(e)})):n.fieldValue=i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name)||n.fieldValue),t.addFieldController(this),this.getFieldValue=function(){var t,i,a={};return n.multiple?n.fieldValue.length>0?(t=[],angular.forEach(n.fieldValue,function(e){t.push(e.join(","))})):t="":t=n.fieldValue?n.fieldValue.join(","):"",n.multiple&&n.multiname?(i=[],angular.forEach(t,function(e){var t={};t[n.multiname]=e,i.push(t)})):i=t,e.parentField?n.parentFieldIndex?(a[e.parentField]=[],a[e.parentField][n.parentFieldIndex]={},a[e.parentField][n.parentFieldIndex][n.fieldName]=i):(a[e.parentField]={},a[e.parentField][n.fieldName]=i):a[n.fieldName]=i,a},this.getInitialValue=function(){var t={};return e.parentField?n.multiple?(t[e.parentField]={},t[e.parentField][n.fieldName]=[]):(t[e.parentField]={},t[e.parentField][n.fieldName]=""):n.multiple?t[n.fieldName]=[]:t[n.fieldName]="",t},n.addItem=function(){},n.removeItem=function(e){e="undefined"!=typeof e?e:-1,e>=0?angular.forEach(n.fieldValue,function(t,i){i==e&&n.fieldValue.splice(e,1)}):n.fieldValue=""},n.afterInit=function(e){n.map=e},n.mapDoubleClick=function(e){var t=e.get("coords");n.multiple?n.fieldValue.push(t):n.fieldValue||(n.fieldValue=t)},e.$on("editor:entity_loaded",function(t,i){return"new"===i.editorEntityType||null===i[e.field.name]?void(n.fieldValue=n.multiple?[]:""):void(e.parentField?n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(i[e.parentField][e.field.name],function(e){n.fieldValue.push(e[n.multiname].split(","))})):(n.fieldValue=[],angular.forEach(i[e.parentField][e.field.name],function(e){n.fieldValue.push(e.split(","))})):n.fieldValue=i[e.parentField][e.field.name]?i[e.parentField][e.field.name].split(","):"":n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(i[e.field.name],function(e){n.fieldValue.push(e[n.multiname].split(","))})):(n.fieldValue=[],angular.forEach(i[e.field.name],function(e){n.fieldValue.push(e.split(","))})):n.fieldValue=i[e.field.name]?i[e.field.name].split(","):"")}),e.$on("editor:api_error_field_"+a,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$on("$destroy",function(){t.deleteFieldController(n),n.parentFieldIndex&&i.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,n.fieldValue)}),e.$watch(function(){return n.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("universal.editor").controller("EditorFieldMapController",e),e.$inject=["$scope","EditEntityStorage","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldMap/editorFieldMap.html"),controller:"EditorFieldMapController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldMap",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldMap/editorFieldMap.html",'\n<div>\n    <div class="field-map-wrapper col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <ya-map data-ya-center="{{vm.mapParam.center}}" data-ya-zoom="{{vm.mapParam.zoom}}" data-ya-after-init="vm.afterInit($target)" data-ya-event-dblclick="vm.mapDoubleClick($event)" data-ya-controls="zoomControl searchControl fullscreenControl" data-ya-behaviors="scrollZoom multiTouch drag" style="width: {{vm.mapParam.width}}px; height: {{vm.mapParam.height}}px; display: block;">\n            <ya-geo-object data-ng-if="!vm.multiple &amp;&amp; vm.fieldValue" data-ya-source="{geometry:{type : \'Point\', coordinates : vm.fieldValue}}"></ya-geo-object>\n            <ya-geo-object data-ng-if="vm.multiple" data-ng-repeat="mark in vm.fieldValue track by $index" data-ya-source="{geometry:{type : \'Point\', coordinates : mark}, properties : { iconContent : $index + 1 }}"></ya-geo-object>\n        </ya-map>\n        <div class="field-map-values">\n            <div data-ng-if="vm.multiple" data-ng-repeat="item in vm.fieldValue track by $index" class="item-map-wrapper">\n                <div data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly &amp;&amp; vm.fieldValue.length" class="btn btn-primary btn-xs">{{\'BUTTON.DELETE_MARK\' | translate}} {{$index + 1}}</div>\n            </div>\n            <div data-ng-if="!vm.multiple" class="item-map-wrapper">\n                <div data-ng-click="vm.removeItem()" data-ng-if="!vm.readonly &amp;&amp; vm.fieldValue" class="btn btn-primary btn-xs">{{\'BUTTON.DELETE_MARK\' | translate}}</div>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a){function n(){r.fieldValue=r.parentFieldIndex?[]:e.field.defaultValue||null}var l,r=this;l=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName;var d=e.field.valuesRemote;if(r.field_id="id",r.field_search="title",d&&d.fields&&(d.fields.value&&(r.field_id=d.fields.value),d.fields.label&&(r.field_search=d.fields.label)),r.fieldName=e.field.name,r.selectedValues=[],r.inputValue="",r.readonly=e.field.readonly||!1,e.$parent.vm.error=[],r.parentFieldIndex=e.parentFieldIndex||!1,(e.field.multiname||angular.isString(e.field.multiname))&&(r.multiname=""+e.field.multiname||"value"),t.addFieldController(this),r.fieldValue=e.field.defaultValue||null,r.parentFieldIndex){r.fieldValue=[];var o=a.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name);o&&(r.multiname?r.fieldValue=o[r.multiname]:r.fieldValue=o)}e.field.hasOwnProperty("values")?angular.forEach(e.field.values,function(t,i){var a={};a[r.field_id]=i,a[r.field_search]=t,i===e.field.defaultValue&&(r.fieldValue=i),r.selectedValues.push(a)}):e.field.hasOwnProperty("valuesRemote")?i.getUrlResource(e.field.valuesRemote.url).then(function(t){angular.forEach(t.data.items,function(t){e.field.defaultValue&&t[r.field_id]===e.field.defaultValue&&(r.fieldValue=t[r.field_id]),r.selectedValues.push(t)})},function(t){console.error('EditorFieldRadiolistController: Не удалось получить значения для поля "'+e.field.fieldName+'" с удаленного ресурса')}):console.error("EditorFieldRadiolistController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFieldValue=function(){var t,i={};if(r.multiname){var a={};a[r.multiname]=r.fieldValue,t=a}else t=r.fieldValue;return e.parentField?r.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][r.parentFieldIndex]={},i[e.parentField][r.parentFieldIndex][r.fieldName]=t):(i[e.parentField]={},i[e.parentField][r.fieldName]=t):i[r.fieldName]=t,i},this.getInitialValue=function(){var t={};return e.parentField?(t[e.parentField]={},t[e.parentField][r.fieldName]=null):t[r.fieldName]=null,t},e.$on("editor:entity_loaded",function(i,a){e.field.requiredField&&e.$watch(function(){var i=t.getValueField(e.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(i),a},function(t){t?r.readonly=e.field.readonly||!1:(n(),r.readonly=!0)},!0),"new"!==a.editorEntityType&&(e.parentField?r.multiname?r.fieldValue=a[e.parentField][e.field.name][r.multiname]:r.fieldValue=a[e.parentField][e.field.name]:r.multiname?r.fieldValue=a[e.field.name][r.multiname]:r.fieldValue=a[e.field.name])}),e.$on("$destroy",function(){t.deleteFieldController(r),r.parentFieldIndex&&a.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,r.fieldValue)}),e.$on("editor:api_error_field_"+l,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$watch(function(){return r.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("universal.editor").controller("EditorFieldRadiolistController",e),e.$inject=["$scope","EditEntityStorage","RestApiService","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldRadiolist/editorFieldRadiolist.html"),controller:"EditorFieldRadiolistController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldRadiolist",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldRadiolist/editorFieldRadiolist.html",'\n<div>\n    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <div data-ng-repeat="item in vm.selectedValues" data-ng-class="vm.readonly ? \'disabled\' : \'\'" class="radio">\n            <label>\n                <input type="radio" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" value="{{item[vm.field_id]}}"/>{{item[vm.field_search]}}\n            </label>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t){}angular.module("universal.editor").controller("DropdownItemsController",e),e.$inject=["$scope","RestApiService"]}(),function(){"use strict";function e(e,t,i){function a(e,t){angular.isFunction(t)&&(t={post:t});var a,n=e.contents().remove();return{post:function(e,l){a||(a=i(n)),a(e,function(e){l.append(e)}),t&&t.post&&t.post.apply(null,arguments)}}}return{restrict:"A",replace:!0,scope:{options:"=",isOpen:"=",fieldSearch:"=",childCountField:"=",onToggle:"=",api:"=",selectBranches:"=",assetsPath:"="},template:e.get("module/directives/editorFieldSelect/dropdownItems.html"),controller:"DropdownItemsController",controllerAs:"vm",compile:a}}angular.module("universal.editor").directive("dropdownItems",e),e.$inject=["$templateCache","$document","$compile"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldSelect/dropdownItems.html",'\n<div data-ng-show="isOpen">\n    <div data-ng-repeat="option in options track by $index" class="dropdown-items__item">\n        <div class="option">\n            <div data-ng-if="::selectBranches || !option[childCountField]" data-ng-click="onToggle($event, option)" class="option__checkbox">\n                <div data-ng-style="{\'display\': option.checked ? \'block\' : \'\', \'background-image\':\'url(\'+ assetsPath +\'/images/checkbox_green.png)\'}" class="checkbox__check"></div>\n            </div>\n            <div data-ng-click="onToggle($event, option, true)" class="option__label"> <span data-ng-bind="option[fieldSearch]"></span> <span data-ng-if="option[childCountField]" data-ng-class="{\'option__child-count_open\': option.isOpen}" class="option__child-count">({{option.child_count}})</span>\n            </div>\n        </div>\n        <div data-ng-if="option[childCountField]" data-ng-show="!!option.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">Выполняется действие</div>\n        </div>\n        <div data-ng-if="option.childOpts" data-dropdown-items="" data-options="option.childOpts" data-is-open="option.isOpen" data-field-search="fieldSearch" data-child-count-field="childCountField" data-on-toggle="onToggle" data-api="api" data-select-branches="selectBranches" data-assets-path="assetsPath" class="dropdown-items__children"></div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a,n,l,r){function d(e){V.loadingData=!0,a.getUrlResource(t.field.valuesRemote.url).then(function(t){angular.forEach(t.data.items,function(e){V.options.push(e)}),e?b():y()},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+t.field.fieldName+'" с удаленного ресурса')})["finally"](function(){V.loadingData=!1})}function o(){V.loadingData=!0,a.getUrlResource(t.field.valuesRemote.url+'?filter={"id":["'+E.join('","')+'"]}').then(function(e){V.multiple?angular.forEach(e.data.items,function(e){V.fieldValue.push(e)}):V.fieldValue=[e.data.items[0]],d(!0)},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+t.field.fieldName+'" с удаленного ресурса')})["finally"](function(){V.loadingData=!1})}function u(){V.fieldValue=t.field.hasOwnProperty("multiple")&&t.field.multiple===!0?[]:"",V.selectedValues=[],V.inputValue=""}function s(e,i,n){if(n&&i[V.treeChildCountField])i.isOpen=!i.isOpen,i[V.treeChildCountField]&&!i.childOpts&&(i.loadingData=!0,a.getUrlResource(t.field.valuesRemote.url+'?filter={"'+V.treeParentField+'":"'+i[V.field_id]+'"}').then(function(e){i.childOpts||(i.childOpts=[]),i.loadingData=!1,angular.forEach(e.data.items,function(e){i.childOpts.push(e)}),V.filterText||(x=angular.copy(V.options)),V.fieldValue.length&&b(i)},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+t.field.fieldName+'" с удаленного ресурса')}));else{angular.isArray(V.fieldValue)||(V.fieldValue=[]);var l=g(i[V.field_id]);V.multiple?null!==l?(i.checked=!1,V.fieldValue.splice(l,1)):(i.checked=!0,V.fieldValue.push(i)):null===l?(V.fieldValue.splice(0),c(V.options),i.checked=!0,V.fieldValue.push(i)):(V.fieldValue.splice(0),i.checked=!1)}e.stopPropagation()}function c(e){for(var t=0,i=e.length;t<i;t++)e[t].checked=!1,e[t].childOpts&&c(e[t].childOpts)}function m(e,t){if(V.treeParentField&&t[V.treeParentField]&&V.multiple){h(V.options,t[V.treeParentField],t[V.field_id]);var i=g(t[V.field_id],t[V.treeParentField]);null!==i&&V.fieldValue.splice(i,1)}else{var i=g(t[V.field_id]);if(null!==i){V.fieldValue.splice(i,1);for(var a=0,n=V.options.length;a<n;a++)V.options[a][V.field_id]===t[V.field_id]&&(V.options[a].checked=!1)}}e.stopPropagation()}function f(e){t.toggleDropdown(e),t.isOpen=!0,e.stopPropagation()}function p(){return V.filterText?(x||(x=angular.copy(V.options)),void(V.options=v(angular.copy(x),V.filterText))):void(x&&(V.options=x))}function v(e,t){var i=[];return i=e.filter(function(e){return e.childOpts&&e.childOpts.length&&(e.childOpts=v(e.childOpts,t)),e[V.field_search].indexOf(t)>-1||e.childOpts&&e.childOpts.length})}function g(e,t){if(t){for(var i=0,a=V.fieldValue.length;i<a;i++)if(V.fieldValue[i][V.field_id]===e&&V.fieldValue[i][V.treeParentField]===t)return i}else for(var i=0,a=V.fieldValue.length;i<a;i++)if(V.fieldValue[i][V.field_id]===e)return i;return null}function h(e,t,i){for(var a=0,n=e.length;a<n;a++)if(e[a][V.field_id]===t&&e[a].childOpts)for(var l=0,r=e[a].childOpts.length;l<r;l++)e[a].childOpts[l][V.field_id]===i&&(e[a].childOpts[l].checked=!1);else e[a].childOpts&&e[a].childOpts.length&&h(e[a].childOpts,t,i)}function y(){E.length&&V.options.length&&(V.fieldValue=V.options.filter(function(e){for(var t=0,i=E.length;t<i;t++)if(e[V.field_id]===E[t])return e.checked=!0,!0}),E.splice(0))}function b(e){if(e)for(var t=0,i=e.childOpts.length;t<i;t++)for(var a=0,n=V.fieldValue.length;a<n;a++)e[V.field_id]===V.fieldValue[a][V.treeParentField]&&e.childOpts[t][V.field_id]===V.fieldValue[a][V.field_id]&&(e.childOpts[t].checked=!0);else for(var t=0,i=V.options.length;t<i;t++)for(var a=0,n=V.fieldValue.length;a<n;a++)V.options[t][V.field_id]!==V.fieldValue[a][V.field_id]||V.fieldValue[a][V.treeParentField]||(V.options[t].checked=!0)}var F,V=this;F=t.parentField?t.parentFieldIndex?t.parentField+"_"+t.parentFieldIndex+"_"+t.fieldName:t.parentField+"_"+t.fieldName:t.fieldName;var $=t.field.valuesRemote;V.field_id="id",V.field_search="title",$&&$.fields&&($.fields.value&&(V.field_id=$.fields.value),$.fields.label&&(V.field_search=$.fields.label)),V.assetsPath="../assets";var E=[];V.fieldName=t.field.name,V.options=[],V.selectedValues=[],V.inputValue="",V.readonly=t.field.readonly||!1,t.$parent.vm.error=[],V.parentFieldIndex=t.parentFieldIndex||!1,V.depend=t.field.depend||!1,V.parentValue=!V.depend,V.search=t.field.search,t.field.hasOwnProperty("valuesRemote")&&t.field.tree&&t.field.tree.parentField&&t.field.tree.childCountField&&(V.treeParentField=t.field.tree.parentField,V.treeChildCountField=t.field.tree.childCountField,V.treeSelectBranches=t.field.tree.selectBranches,V.isTree=V.treeParentField&&V.treeChildCountField),V.depend&&(V.dependField=V.depend.fieldName,V.dependFilter=V.depend.filter),t.field.hasOwnProperty("multiple")&&t.field.multiple===!0?(V.multiple=!0,V.fieldValue=[],(t.field.multiname||angular.isString(t.field.multiname))&&(V.multiname=""+t.field.multiname||"value")):(V.multiple=!1,V.fieldValue=""),V.parentFieldIndex&&(V.multiple?(V.fieldValue=[],angular.forEach(n.getFieldValue(t.parentField,t.parentFieldIndex,t.field.name),function(e){V.multiname?E.push(e[V.multiname]):E.push(e)})):n.getFieldValue(t.parentField,t.parentFieldIndex,t.field.name)&&(V.isTree?E.push(n.getFieldValue(t.parentField,t.parentFieldIndex,t.field.name)):V.fieldValue=n.getFieldValue(t.parentField,t.parentFieldIndex,t.field.name))),i.addFieldController(this),t.field.hasOwnProperty("values")?angular.forEach(t.field.values,function(e,t){var i={};i[V.field_id]=t,i[V.field_search]=e,V.options.push(i)}):t.field.hasOwnProperty("valuesRemote")?V.isTree&&(E.length&&!V.options.length?o():E.length||d()):console.error("EditorFieldSelectController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFieldValue=function(){var e,i={};return(!V.multiple&&V.fieldValue||V.multiple&&V.fieldValue.length)&&(V.multiname?(e=[],angular.forEach(V.fieldValue,function(t){var i={};i[V.multiname]=V.isTree?t[V.field_id]:t,e.push(i)})):V.multiple?(e=[],angular.forEach(V.fieldValue,function(t){e.push(V.isTree?t[V.field_id]:t)})):e=V.isTree&&V.fieldValue.length?V.fieldValue[0][V.field_id]:V.fieldValue[V.field_id]),t.parentField?V.parentFieldIndex?(i[t.parentField]=[],i[t.parentField][V.parentFieldIndex]={},i[t.parentField][V.parentFieldIndex][V.fieldName]=e):(i[t.parentField]={},i[t.parentField][V.fieldName]=e):i[V.fieldName]=e,i},this.getInitialValue=function(){var e={};return t.parentField?V.multiple?(e[t.parentField]={},e[t.parentField][V.fieldName]=[]):(e[t.parentField]={},e[t.parentField][V.fieldName]=void 0):V.multiple?e[V.fieldName]=[]:e[V.fieldName]=void 0,e},t.$on("editor:entity_loaded",function(e,a){if(V.fieldValue={},t.field.requiredField&&t.$watch(function(){var e=i.getValueField(t.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(e),a},function(e){e?V.readonly=t.field.readonly||!1:(u(),V.readonly=!0)},!0),"new"!==a.editorEntityType)if(V.parentValue=!V.dependField,t.parentField)if(V.multiple)V.multiname?(V.fieldValue=[],angular.forEach(a[t.parentField][t.field.name],function(e){E.push(e[V.multiname])})):(V.fieldValue=[],angular.forEach(a[t.parentField][t.field.name],function(e){E.push(e)}));else if(V.isTree&&a[t.parentField][t.field.name])E.push(a[t.parentField][t.field.name]);else{var n={};n[V.field_id]=a[t.parentField][t.field.name],V.fieldValue=n}else if(V.multiple)V.multiname?(V.fieldValue=[],angular.forEach(a[t.field.name],function(e){E.push(e[V.multiname])})):(V.fieldValue=[],angular.forEach(a[t.field.name],function(e){E.push(e)}));else if(V.isTree&&a[t.field.name])E.push(a[t.field.name]);else{var n={};n[V.field_id]=a[t.field.name],V.fieldValue=n}else if(V.fieldValue=V.multiple?[]:void 0,a.hasOwnProperty(t.field.name)){var n={};n[V.field_id]=a[t.field.name],isNaN(+n[V.field_id])||(n[V.field_id]=+n[V.field_id]),V.fieldValue=n}}),t.$on("editor:api_error_field_"+F,function(e,i){angular.isArray(i)?angular.forEach(i,function(e){t.$parent.vm.error.indexOf(e)<0&&t.$parent.vm.error.push(e)}):t.$parent.vm.error.indexOf(i)<0&&t.$parent.vm.error.push(i)}),t.$on("$destroy",function(){i.deleteFieldController(V),V.parentFieldIndex&&n.fieldDestroy(t.parentField,t.parentFieldIndex,t.field.name,V.fieldValue)}),t.$watch(function(){return V.fieldValue},function(i){t.$parent.vm.error=[],e.$broadcast("select_field:select_name_"+V.fieldName,i)},!0),V.depend&&t.$on("select_field:select_name_"+V.dependField,function(e,i){i&&""!==i?(V.parentValue=!1,V.options=[],a.getUrlResource(t.field.valuesRemote.url+'?filter={"'+V.dependFilter+'":"'+i+'"}').then(function(e){angular.forEach(e.data.items,function(e){V.options.push(e)}),V.parentValue=!0},function(e){console.error('EditorFieldSelectController: Не удалось получить значения для поля "'+t.field.fieldName+'" с удаленного ресурса')})):V.parentValue=!1});var x;V.toggle=s,V.remove=m,V.focus=f,V.change=p}angular.module("universal.editor").controller("EditorFieldSelectController",e),e.$inject=["$rootScope","$scope","EditEntityStorage","RestApiService","ArrayFieldStorage","$timeout","configData"],angular.module("universal.editor").filter("selectedValues",function(){return function(e,t){var i=e.map(function(e){return e[t]});return i.join(", ")}})}(),function(){"use strict";function e(e,t){function i(e,i,a,n){i.on("$destroy",function(){e.$destroy()}),e.isOpen=!1,t.on("click",function(){e.isOpen=!1}),e.toggleDropdown=function(t){var a=$(document).height(),n=$(i).find(".dropdown__host"),l=n.height(),r=n.offset(),d=r.top+l;a-d<500?$(i).find(".dropdown__items").css("max-height",a-d+"px"):$(i).find(".dropdown__items").css("max-height",""),e.isOpen=!e.isOpen,t.stopPropagation()}}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldSelect/editorFieldSelect.html"),controller:"EditorFieldSelectController",controllerAs:"vm",link:i}}angular.module("universal.editor").directive("editorFieldSelect",e),e.$inject=["$templateCache","$document"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldSelect/editorFieldSelect.html",'\n<div>\n    <div data-ng-if="vm.multiple &amp;&amp; !vm.isTree" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <select name="{{vm.fieldName}}" data-ng-disabled="vm.readonly || !vm.parentValue" data-ng-model="vm.fieldValue" multiple="multiple" class="form-control">\n            <option data-ng-repeat="option in vm.options" value="{{option[vm.field_id]}}">{{option[vm.field_search]}}</option>\n        </select>\n        <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n        </div>\n    </div>\n    <div data-ng-if="!vm.multiple &amp;&amp; !vm.isTree" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <select name="{{vm.fieldName}}" data-ng-disabled="vm.readonly || !vm.parentValue" data-ng-model="vm.fieldValue" ng-options="option[vm.field_search] for option in vm.options track by option[vm.field_id]" class="form-control">\n            <option value="" data-ng-show="!vm.required &amp;&amp; !vm.loadingData">--- {{\'SELECT_VALUE\' | translate}} ---</option>\n        </select>\n        <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n        </div>\n    </div>\n    <div data-ng-if="vm.isTree" class="dropdown col-lg-3 col-md-3 col-sm-3 col-xs-3">\n        <div data-ng-click="toggleDropdown($event)" class="dropdown__host">\n            <div data-ng-if="vm.fieldValue.length &amp;&amp; (vm.multiple || vm.treeParentField &amp;&amp; vm.treeChildCountField)" class="dropdown__selected-items dropdown__selected-items_with-borders form-control">\n                <ul class="selected-items">\n                    <li data-ng-repeat="value in vm.fieldValue" class="selected-items__item">\n                        <div class="selected-item">{{value[vm.field_search]}}<span data-ng-click="vm.remove($event, value)" class="selected-item__btn_delete">x</span></div>\n                    </li>\n                </ul>\n            </div>\n            <div data-ng-class="{\'dropdown__title_open\': isOpen}" class="dropdown__title form-control">\n                <input data-ng-show="vm.search" data-ng-model="vm.filterText" data-ng-focus="vm.focus($event)" data-ng-change="vm.change()" data-ng-click="vm.focus($event)" placeholder="{{\'SEARCH_ELEMENTS\' | translate}}" class="dropdown__search-field"/>\n                <div data-ng-if="!vm.search">\n                    <div class="dropdown__selected-items">{{vm.fieldValue | limitTo: 10 | selectedValues: vm.field_search}}</div>\n                    <div data-ng-if="!vm.loadingData &amp;&amp; !vm.fieldValue.length" class="dropdown__selected-items">--- {{\'SELECT_VALUE\' | translate}} ---</div>\n                </div>\n            </div>\n        </div>\n        <div data-ng-if="::(vm.treeParentField &amp;&amp; vm.treeChildCountField)" data-ng-class="{\'dropdown__items_with-selected\': vm.fieldValue.length &gt; 2 || (vm.search &amp;&amp; vm.fieldValue.length)}" data-dropdown-items="" data-options="vm.options" data-is-open="isOpen &amp;&amp; vm.options.length" data-field-search="vm.field_search" data-child-count-field="vm.treeChildCountField" data-on-toggle="vm.toggle" data-api="field.values_remote.api" data-select-branches="vm.treeSelectBranches" data-assets-path="vm.assetsPath" class="dropdown__items dropdown__items_with-padding"></div>\n        <div data-ng-show="!!vm.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){function a(){l.fieldValue=e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?[]:""}var n,l=this;n=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,l.fieldName=e.field.name,l.fieldValue=void 0,l.readonly=e.field.readonly||!1,e.$parent.vm.error=[],l.parentFieldIndex=e.parentFieldIndex||!1,l.mask=e.field.mask||!1,e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(l.multiple=!0,l.fieldValue=[],(e.field.multiname||angular.isString(e.field.multiname))&&(l.multiname=""+e.field.multiname||"value")):(l.multiple=!1,l.fieldValue=""),l.parentFieldIndex&&(l.multiple?(l.fieldValue=[],angular.forEach(i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){l.multiname?l.fieldValue.push(e[l.multiname]):l.fieldValue.push(e)})):l.fieldValue=i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name)||""),t.addFieldController(this),this.getFieldValue=function(){var t,i={};return l.multiname?(t=[],angular.forEach(l.fieldValue,function(e){var i={};i[l.multiname]=e,t.push(i)})):l.multiple?(t=[],angular.forEach(l.fieldValue,function(e){t.push(e)})):t=l.fieldValue,e.parentField?l.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][l.parentFieldIndex]={},i[e.parentField][l.parentFieldIndex][l.fieldName]=t):(i[e.parentField]={},i[e.parentField][l.fieldName]=t):i[l.fieldName]=t,i},this.getInitialValue=function(){var t={};return e.parentField?l.multiple?(t[e.parentField]={},t[e.parentField][l.fieldName]=[""]):(t[e.parentField]={},t[e.parentField][l.fieldName]=""):l.multiple?t[l.fieldName]=[""]:t[l.fieldName]="",t},l.addItem=function(){l.fieldValue.push("")},l.removeItem=function(e){angular.forEach(l.fieldValue,function(t,i){i==e&&l.fieldValue.splice(e,1)})},l.inputLeave=function(t){if(t){if(e.field.hasOwnProperty("maxLength")&&t.length>e.field.maxLength){var i="Для поля превышено максимальное допустимое значение в "+e.field.maxLength+" символов. Сейчас введено "+t.length+" символов.";
e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}if(e.field.hasOwnProperty("minLength")&&t.length<e.field.minLength){var a="Минимальное значение поля не может быть меньше "+e.field.minLength+" символов. Сейчас введено "+t.length+" символов.";e.$parent.vm.error.indexOf(a)<0&&e.$parent.vm.error.push(a)}}},e.$on("editor:entity_loaded",function(i,n){return e.field.requiredField&&e.$watch(function(){var i=t.getValueField(e.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(i),a},function(t){t?l.readonly=e.field.readonly||!1:(a(),l.readonly=!0)},!0),"new"===n.editorEntityType?(l.fieldValue=l.multiple?[""]:"",void(n.hasOwnProperty(e.field.name)&&(l.fieldValue=n[e.field.name]))):void(e.parentField?l.multiple?l.multiname?(l.fieldValue=[],angular.forEach(n[e.parentField][e.field.name],function(e){l.fieldValue.push(e[l.multiname])})):(l.fieldValue=[],angular.forEach(n[e.parentField][e.field.name],function(e){l.fieldValue.push(e)})):l.fieldValue=n[e.parentField][e.field.name]:l.multiple?l.multiname?(l.fieldValue=[],angular.forEach(n[e.field.name],function(e){l.fieldValue.push(e[l.multiname])})):(l.fieldValue=[],angular.forEach(n[e.field.name],function(e){l.fieldValue.push(e)})):l.fieldValue=n[e.field.name])}),e.$on("editor:api_error_field_"+n,function(t,i){e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$on("editor:api_error_field_"+n,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$on("$destroy",function(){t.deleteFieldController(l),l.parentFieldIndex&&i.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,l.fieldValue)}),e.$watch(function(){return l.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("universal.editor").controller("EditorFieldStringController",e),e.$inject=["$scope","EditEntityStorage","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldString/editorFieldString.html"),controller:"EditorFieldStringController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldString",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldString/editorFieldString.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-string-wrapper input-group">\n            <input type="text" data-ui-mask="{{vm.mask}}" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue[$index]" data-ng-blur="vm.inputLeave(vm.fieldValue[$index])" class="form-control input-sm"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <input type="text" data-ui-mask="{{vm.mask}}" data-ng-disabled="vm.readonly" name="{{vm.fieldName}}" data-ng-model="vm.fieldValue" data-ng-blur="vm.inputLeave(vm.fieldValue)" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){function a(){l.fieldValue=e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?[]:""}var n,l=this;n=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,l.fieldName=e.field.name,l.fieldValue="",l.readonly=e.field.readonly||!1,e.$parent.vm.error=[],l.parentFieldIndex=e.parentFieldIndex||!1,e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(l.multiple=!0,l.fieldValue=[],(e.field.multiname||angular.isString(e.field.multiname))&&(l.multiname=""+e.field.multiname||"value")):(l.multiple=!1,l.fieldValue=""),l.parentFieldIndex&&(l.multiple?(l.fieldValue=[],angular.forEach(i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){l.multiname?l.fieldValue.push(e[l.multiname]):l.fieldValue.push(e)})):l.fieldValue=i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name)||""),t.addFieldController(this),this.getFieldValue=function(){var t,i={};return l.multiname?(t=[],angular.forEach(l.fieldValue,function(e){var i={};i[l.multiname]=e,t.push(i)})):l.multiple?(t=[],angular.forEach(l.fieldValue,function(e){t.push(e)})):t=l.fieldValue,e.parentField?l.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][l.parentFieldIndex]={},i[e.parentField][l.parentFieldIndex][l.fieldName]=t):(i[e.parentField]={},i[e.parentField][l.fieldName]=t):i[l.fieldName]=t,i},this.getInitialValue=function(){var t={};return e.parentField?l.multiple?(t[e.parentField]={},t[e.parentField][l.fieldName]=[""]):(t[e.parentField]={},t[e.parentField][l.fieldName]=""):l.multiple?t[l.fieldName]=[""]:t[l.fieldName]="",t},l.addItem=function(){l.fieldValue.push("")},l.removeItem=function(e){angular.forEach(l.fieldValue,function(t,i){i==e&&l.fieldValue.splice(e,1)})},l.inputLeave=function(t){if(t){if(e.field.hasOwnProperty("maxLength")&&t.length>e.field.maxLength){var i="Для поля превышено максимальное допустимое значение в "+e.field.maxLength+" символов. Сейчас введено "+t.length+" символов.";e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}if(e.field.hasOwnProperty("minLength")&&t.length<e.field.minLength){var a="Минимальное значение поля не может быть меньше "+e.field.minLength+" символов. Сейчас введено "+t.length+" символов.";e.$parent.vm.error.indexOf(a)<0&&e.$parent.vm.error.push(a)}}},e.$on("editor:entity_loaded",function(i,n){return e.field.requiredField&&e.$watch(function(){var i=t.getValueField(e.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(i),a},function(t){t?l.readonly=e.field.readonly||!1:(a(),l.readonly=!0)},!0),"new"===n.editorEntityType?void(l.fieldValue=l.multiple?[""]:""):void(e.parentField?l.multiple?l.multiname?(l.fieldValue=[],angular.forEach(n[e.parentField][e.field.name],function(e){l.fieldValue.push(e[l.multiname])})):(l.fieldValue=[],angular.forEach(n[e.parentField][e.field.name],function(e){l.fieldValue.push(e)})):l.fieldValue=n[e.parentField][e.field.name]:l.multiple?l.multiname?(l.fieldValue=[],angular.forEach(n[e.field.name],function(e){l.fieldValue.push(e[l.multiname])})):(l.fieldValue=[],angular.forEach(n[e.field.name],function(e){l.fieldValue.push(e)})):l.fieldValue=n[e.field.name])}),e.$on("editor:api_error_field_"+n,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$on("$destroy",function(){t.deleteFieldController(l),l.parentFieldIndex&&i.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,l.fieldValue)}),e.$watch(function(){return l.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("universal.editor").controller("EditorFieldTextareaController",e),e.$inject=["$scope","EditEntityStorage","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldTextarea/editorFieldTextarea.html"),controller:"EditorFieldTextareaController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldTextarea",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldTextarea/editorFieldTextarea.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-textarea-wrapper">\n            <div>\n                <textarea name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-ng-blur="vm.inputLeave(vm.fieldValue[$index])" class="form-control editor-textarea"></textarea>\n                <div data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</div>\n            </div>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <div>\n            <textarea name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-ng-blur="vm.inputLeave(vm.fieldValue)" class="form-control editor-textarea"></textarea>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a,n){function l(){d.fieldValue=e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?[]:""}var r,d=this;if(r=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,d.fieldName=e.field.name,d.fieldValue="",d.readonly=e.field.readonly||!1,d.sourceTime=a(),e.$parent.vm.error=[],d.parentFieldIndex=e.parentFieldIndex||!1,e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(d.multiple=!0,d.fieldValue=[],(e.field.multiname||angular.isString(e.field.multiname))&&(d.multiname=""+e.field.multiname||"value")):(d.multiple=!1,d.fieldValue=""),d.parentFieldIndex)if(d.multiple)d.fieldValue=[],angular.forEach(n.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){d.multiname?d.fieldValue.push(e[d.multiname]?a(e[d.multiname],"YYYY-MM-DD HH:mm:ss"):""):d.fieldValue.push(e?a(e,"YYYY-MM-DD HH:mm:ss"):"")});else{var o=n.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name);d.fieldValue=o?a(o,"YYYY-MM-DD HH:mm:ss"):d.fieldValue}t.addFieldController(this),this.getFieldValue=function(){var t,i={};return d.multiname?(t=[],angular.forEach(d.fieldValue,function(e){if(e&&""!==e&&a.isMoment(e)){var i={};i[d.multiname]=a(e).format("YYYY-MM-DD HH:mm:ss"),t.push(i)}})):d.multiple?(t=[],angular.forEach(d.fieldValue,function(e){t.push(a(e).format("YYYY-MM-DD HH:mm:ss"))})):t=d.fieldValue&&""!==d.fieldValue&&a.isMoment(d.fieldValue)?a(d.fieldValue).format("YYYY-MM-DD HH:mm:ss"):"",e.parentField?d.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][d.parentFieldIndex]={},i[e.parentField][d.parentFieldIndex][d.fieldName]=t):(i[e.parentField]={},i[e.parentField][d.fieldName]=t):i[d.fieldName]=t,i},this.getInitialValue=function(){var t={};return e.parentField?d.multiple?(t[e.parentField]={},t[e.parentField][d.fieldName]=[]):(t[e.parentField]={},t[e.parentField][d.fieldName]=a()):d.multiple?t[d.fieldName]=[]:t[d.fieldName]=a(),t},d.addItem=function(){d.fieldValue.push(a())},d.removeItem=function(e){angular.forEach(d.fieldValue,function(t,i){i==e&&d.fieldValue.splice(e,1)})},e.$on("editor:entity_loaded",function(i,n){return e.field.requiredField&&e.$watch(function(){var i=t.getValueField(e.field.requiredField),a=!1,n=!1;return function(e){for(var t=Object.keys(e),i=t.length;i--;){var l=e[t[i]];null!==l&&void 0!==l&&""!==l&&(angular.isObject(l)&&!n&&arguments.callee(l),a=!0,n=!0)}}(i),a},function(t){t?d.readonly=e.field.readonly||!1:(l(),d.readonly=!0)},!0),"new"===n.editorEntityType?void(d.fieldValue=d.multiple?[]:a()):void(e.parentField?d.multiple?d.multiname?(d.fieldValue=[],angular.forEach(n[e.parentField][e.field.name],function(e){d.fieldValue.push(a(e[d.multiname],"YYYY-MM-DD HH:mm:ss"))})):(d.fieldValue=[],angular.forEach(n[e.parentField][e.field.name],function(e){d.fieldValue.push(a(e,"YYYY-MM-DD HH:mm:ss"))})):d.fieldValue=n[e.parentField][e.field.name]?a(n[e.parentField][e.field.name],"YYYY-MM-DD HH:mm:ss"):"":d.multiple?d.multiname?(d.fieldValue=[],angular.forEach(n[e.field.name],function(e){d.fieldValue.push(a(e[d.multiname],"YYYY-MM-DD HH:mm:ss"))})):(d.fieldValue=[],angular.forEach(n[e.field.name],function(e){d.fieldValue.push(a(e,"YYYY-MM-DD HH:mm:ss"))})):d.fieldValue=n[e.field.name]?a(n[e.field.name],"YYYY-MM-DD HH:mm:ss"):"")}),e.$watch(function(){return d.fieldValue},function(){e.$parent.vm.error=[]},!0),e.$on("$destroy",function(){t.deleteFieldController(d),d.parentFieldIndex&&n.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,d.fieldValue)}),e.$on("editor:api_error_field_"+r,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)})}angular.module("universal.editor").controller("EditorFieldTimeController",e),e.$inject=["$scope","EditEntityStorage","$element","moment","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldTime/editorFieldTime.html"),controller:"EditorFieldTimeController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldTime",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldTime/editorFieldTime.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-timepicker-wrapper input-group">\n            <input name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue[$index]" data-date-time="" data-format="HH:mm" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm timepicker"/><span class="input-group-btn">\n                <button data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</button></span>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="col-lg-2 col-md-2 col-sm-2 col-xs-2">\n        <input name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" data-ng-model="vm.fieldValue" data-date-time="" data-format="HH:mm" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm timepicker"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){var a,n=this;a=e.parentField?e.parentFieldIndex?e.parentField+"_"+e.parentFieldIndex+"_"+e.fieldName:e.parentField+"_"+e.fieldName:e.fieldName,n.fieldName=e.field.name,n.readonly=e.field.readonly||!1,n.fieldValue="",n.wysiwygOptions={menubar:!1,plugins:"advlist autolink link lists charmap",skin:"lightgray",theme:"modern",readonly:n.readonly},e.$parent.vm.error=[],n.parentFieldIndex=e.parentFieldIndex||!1,n.readonly&&(n.wysiwygOptions.toolbar=!1),e.field.hasOwnProperty("multiple")&&e.field.multiple===!0?(n.multiple=!0,n.fieldValue=[],(e.field.multiname||angular.isString(e.field.multiname))&&(n.multiname=""+e.field.multiname||"value")):(n.multiple=!1,n.fieldValue=""),n.parentFieldIndex&&(n.multiple?(n.fieldValue=[],angular.forEach(i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name),function(e){n.multiname?n.fieldValue.push(e[n.multiname]):n.fieldValue.push(e)})):n.fieldValue=i.getFieldValue(e.parentField,e.parentFieldIndex,e.field.name)||""),t.addFieldController(this),this.getFieldValue=function(){var t,i={};return n.multiname?(t=[],angular.forEach(n.fieldValue,function(e){var i={};i[n.multiname]=e,t.push(i)})):n.multiple?(t=[],angular.forEach(n.fieldValue,function(e){t.push(e)})):t=n.fieldValue,e.parentField?n.parentFieldIndex?(i[e.parentField]=[],i[e.parentField][n.parentFieldIndex]={},i[e.parentField][n.parentFieldIndex][n.fieldName]=t):(i[e.parentField]={},i[e.parentField][n.fieldName]=t):i[n.fieldName]=t,i},this.getInitialValue=function(){var t={};return e.parentField?n.multiple?(t[e.parentField]={},t[e.parentField][n.fieldName]=[""]):(t[e.parentField]={},t[e.parentField][n.fieldName]=""):n.multiple?t[n.fieldName]=[""]:t[n.fieldName]="",t},n.addItem=function(){n.fieldValue.push("")},n.removeItem=function(e){angular.forEach(n.fieldValue,function(t,i){i==e&&n.fieldValue.splice(e,1)})},e.$on("editor:entity_loaded",function(t,i){return"new"===i.editorEntityType?void(n.fieldValue=n.multiple?[""]:""):void(e.parentField?n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(i[e.parentField][e.field.name],function(e){n.fieldValue.push(e[n.multiname])})):(n.fieldValue=[],angular.forEach(i[e.parentField][e.field.name],function(e){n.fieldValue.push(e)})):n.fieldValue=i[e.parentField][e.field.name]:n.multiple?n.multiname?(n.fieldValue=[],angular.forEach(i[e.field.name],function(e){n.fieldValue.push(e[n.multiname])})):(n.fieldValue=[],angular.forEach(i[e.field.name],function(e){n.fieldValue.push(e)})):n.fieldValue=i[e.field.name])}),e.$on("editor:api_error_field_"+a,function(t,i){angular.isArray(i)?angular.forEach(i,function(t){e.$parent.vm.error.indexOf(t)<0&&e.$parent.vm.error.push(t)}):e.$parent.vm.error.indexOf(i)<0&&e.$parent.vm.error.push(i)}),e.$on("$destroy",function(){t.deleteFieldController(n),n.parentFieldIndex&&i.fieldDestroy(e.parentField,e.parentFieldIndex,e.field.name,n.fieldValue)}),e.$watch(function(){return n.fieldValue},function(){e.$parent.vm.error=[]},!0)}angular.module("universal.editor").controller("EditorFieldWysiwygController",e),e.$inject=["$scope","EditEntityStorage","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFieldWysiwyg/editorFieldWysiwyg.html"),controller:"EditorFieldWysiwygController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFieldWysiwyg",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFieldWysiwyg/editorFieldWysiwyg.html",'\n<div>\n    <div data-ng-if="vm.multiple" class="field-textarea-wrapper col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <div data-ng-repeat="field_item in vm.fieldValue track by $index" class="item-textarea-wrapper">\n            <div>\n                <textarea data-ui-tinymce="vm.wysiwygOptions" data-ng-model="vm.fieldValue[$index]"></textarea>\n                <div data-ng-click="vm.removeItem($index)" data-ng-if="!vm.readonly" class="btn btn-default btn-sm">x</div>\n            </div>\n        </div>\n        <div data-ng-click="vm.addItem()" data-ng-if="!vm.readonly" class="btn btn-primary btn-sm">{{\'BUTTON.ADD\' | translate}}</div>\n    </div>\n    <div data-ng-if="!vm.multiple" class="field-textarea-wrapper col-lg-6 col-md-6 col-sm-6 col-xs-6">\n        <div>\n            <textarea data-ui-tinymce="vm.wysiwygOptions" data-ng-model="vm.fieldValue"></textarea>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a,n,l,r){function d(t){if(!(""===t||t.length<=f.minCount))if(f.searching=!0,e.filter.hasOwnProperty("values"))angular.forEach(e.filter.values,function(e,i){var a={};o(e,t)&&!s(e)&&(a[f.filter_id]=i,a[f.filter_search]=e,f.possibleValues.push(a))}),f.activeElement=0,f.searching=!1;else{var i={};i[f.filter_search]="%"+t+"%",n.getUrlResource(e.filter.valuesRemote.url+"?filter="+JSON.stringify(i)).then(function(e){angular.forEach(e.data.items,function(e){s(e)||u(e)||f.possibleValues.push(e)}),f.activeElement=0,f.searching=!1},function(t){console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+e.filter.name+'" с удаленного ресурса'),f.searching=!1})}}function o(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>=0}function u(e){var t=!1;return angular.forEach(f.possibleValues,function(i){i[f.filter_id]==e[f.filter_id]&&(t=!0)}),t}function s(e){var t=!1;return f.selectedValue[f.filter_id]==e[f.filter_id]&&(t=!0),t}function c(){if(e.filter.hasOwnProperty("values"))f.preloadedData=!0,f.selectedValue=e.filter.values.length>=1&&e.filter.values[0];else if(e.filter.hasOwnProperty("valuesRemote")){if(void 0===f.filterValue||""===f.filterValue)return void(f.preloadedData=!0);var t;t={},t[f.filter_id]=[],t[f.filter_id].push(f.filterValue),n.getUrlResource(e.filter.valuesRemote.url+"?filter="+JSON.stringify(t)).then(function(e){f.preloadedData=!0,f.selectedValue=e.data.items.length>=1&&e.data.items[0]},function(t){f.preloadedData=!0,console.error('EditorFieldAutocompleteController: Не удалось получить значения для поля "'+e.filter.name+'" с удаленного ресурса')})}else f.preloadedData=!0,console.error("EditorFieldAutocompleteController: Для поля не указан ни один тип получения значений ( локальный или удаленный )")}var m,f=this,p=(e.filterName,angular.element(t[0].getElementsByClassName("possible-values")[0])),v=e.filter.valuesRemote;f.field_id="id",f.field_search="title",v&&v.fields&&(v.fields.value&&(f.field_id=v.fields.value),v.fields.label&&(f.field_search=v.fields.label)),f.filterName=e.filter.name,f.filterDisplayName=e.filter.label,f.selectedValue=!1,f.activeElement=0,f.preloadedData=!1,f.searching=!1,f.minCount=e.filter.minCount||2,f.filterValue=a.search()[f.filterName]||"",f.inputValue="",c(),i.addFilterController(this),t.find("input").bind("keydown",function(e){switch(e.which){case 13:if(e.preventDefault(),f.possibleValues.length<1)break;l(function(){f.addToSelected(f.possibleValues[f.activeElement])},0);break;case 40:if(e.preventDefault(),f.possibleValues.length<1)break;f.activeElement<f.possibleValues.length-1&&(l(function(){f.activeElement++},0),l(function(){var e=angular.element(p[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(p[0].getElementsByClassName("active")[0])[0].clientHeight,i=p[0].scrollTop,a=p[0].clientHeight;e>=a+i&&(p[0].scrollTop+=t+1)},1));break;case 38:if(e.preventDefault(),f.possibleValues.length<1)break;f.activeElement>0&&(l(function(){f.activeElement--},0),l(function(){var e=angular.element(p[0].getElementsByClassName("active")[0])[0].offsetTop,t=angular.element(p[0].getElementsByClassName("active")[0])[0].clientHeight,i=p[0].scrollTop;p[0].clientHeight;e<i&&(p[0].scrollTop-=t+1)},1))}}),this.getFilterValue=function(){var e={};return""!==f.filterValue&&(e[f.filterName]=f.filterValue,e)},this.getInitialValue=function(){var e={};return e[f.filterName]="",e},this.setInitialValue=function(){f.filterValue="",f.selectedValue=!1,f.inputValue=""},e.$on("$destroy",function(){i.deleteFilterController(f)}),e.$watch(function(){return f.inputValue},function(e){m&&l.cancel(m),f.possibleValues=[],m=l(function(){d(e)},300)}),e.$watch(function(){return f.filterValue},function(e){""!==e?a.search(f.filterName,e):a.search(f.filterName,null)}),f.addToSelected=function(e){f.selectedValue=e,f.filterValue=e.id,f.inputValue="",f.possibleValues=[]},f.removeFromSelected=function(){f.selectedValue=!1,f.filterValue=""}}angular.module("universal.editor").controller("EditorFilterAutocompleteController",e),e.$inject=["$scope","$element","FilterFieldsStorage","$location","RestApiService","$timeout","ArrayFieldStorage"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFilterAutocomplete/editorFilterAutocomplete.html"),controller:"EditorFilterAutocompleteController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterAutocomplete",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterAutocomplete/editorFilterAutocomplete.html",'\n<div class="editor-autocomplete-wrapper">\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div data-ng-show="vm.preloadedData" class="selected-values">\n            <div data-ng-show="vm.selectedValue" class="autocomplete-item">{{vm.selectedValue[vm.filter_search]}}<span data-ng-click="vm.removeFromSelected()" class="remove-from-selected">×</span></div>\n        </div>\n        <div data-ng-show="vm.preloadedData" class="autocomplete-input-wrapper">\n            <input type="text" name="{{vm.filterName}}" data-ng-hide="vm.selectedValue" data-ng-model="vm.inputValue" class="form-control input-sm"/>\n            <div data-ng-show="vm.searching" class="loader-search-wrapper">\n                <div class="loader-search">{{\'LOADING\' | translate}}</div>\n            </div>\n            <div data-ng-if="vm.possibleValues.length &gt; 0" class="possible-values">\n                <div data-ng-repeat="possible in vm.possibleValues" data-ng-mouseover="vm.activeElement = $index" data-ng-click="vm.addToSelected(possible)" data-ng-class="vm.activeElement == $index ? \'active\' : \'\'" class="possible-value-item">{{possible[vm.filter_search]}}</div>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){var a=this;a.filterName=e.filter.name,a.filterDisplayName=e.filter.label,a.filterValue=[],a.selectedValues=[];var n=e.filter.valuesRemote;a.field_id="id",a.field_search="title",n&&n.fields&&(n.fields.value&&(a.field_id=n.fields.value),n.fields.label&&(a.field_search=n.fields.label)),t.addFilterController(this),e.filter.hasOwnProperty("values")?angular.forEach(e.filter.values,function(e,t){var i={};i[a.field_id]=t,i[a.field_search]=e,a.selectedValues.push(i)}):e.filter.hasOwnProperty("valuesRemote")?i.getUrlResource(e.filter.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){a.selectedValues.push(e)})},function(t){console.error('EditorFilterCheckboxController: Не удалось получить значения для поля "'+e.filter.fieldName+'" с удаленного ресурса')}):console.error("EditorFilterCheckboxController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFilterValue=function(){var e={};return 0!==a.filterValue.length&&(e[a.filterName]=a.filterValue,e)},this.getInitialValue=function(){var e={};return e[a.filterValue]=[],e},this.setInitialValue=function(){a.filterValue=[]},e.$on("$destroy",function(){t.deleteFilterController(a)})}angular.module("universal.editor").controller("EditorFilterCheckboxController",e),e.$inject=["$scope","FilterFieldsStorage","RestApiService"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFilterCheckbox/editorFilterCheckbox.html"),controller:"EditorFilterCheckboxController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterCheckbox",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterCheckbox/editorFilterCheckbox.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <label data-ng-repeat="item in vm.selectedValues" class="checkbox-inline">\n            <input type="checkbox" data-checklist-model="vm.filterValue" data-checklist-value="item[vm.field_id]"/>{{item[vm.field_search]}}\n        </label>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){var a=this;a.filterName=e.filter.name,a.filterDisplayName=e.filter.label,a.filterValueStartDate="",a.filterValueStartTime="",a.filterValueEndDate="",a.filterValueEndTime="",t.addFilterController(this),this.getFilterValue=function(){var e={};if(""===a.filterValueStartDate&&""===a.filterValueEndDate&&""===a.filterValueStartTime&&""===a.filterValueEndTime)return!1;var t=i.isMoment(a.filterValueStartTime)?" "+i(a.filterValueStartTime).format("HH:mm:ss"):"",n=i.isMoment(a.filterValueEndTime)?" "+i(a.filterValueEndTime).format("HH:mm:ss"):"";return""!==a.filterValueStartDate&&""===a.filterValueEndDate?e[a.filterName]=">="+i(a.filterValueStartDate).format("YYYY-MM-DD")+t:""===a.filterValueStartDate&&""!==a.filterValueEndDate?e[a.filterName]="<="+i(a.filterValueEndDate).format("YYYY-MM-DD")+n:(e[a.filterName]=[],e[a.filterName].push(">="+i(a.filterValueStartDate).format("YYYY-MM-DD")+t),e[a.filterName].push("<="+i(a.filterValueEndDate).format("YYYY-MM-DD")+n)),e},this.getInitialValue=function(){var e={};return e[a.filterName]="",e},this.setInitialValue=function(){a.filterValueStartDate="",a.filterValueStartTime="",a.filterValueEndDate="",a.filterValueEndTime=""},e.$on("$destroy",function(){t.deleteFilterController(a)})}angular.module("universal.editor").controller("EditorFilterDateController",e),e.$inject=["$scope","FilterFieldsStorage","moment"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFilterDate/editorFilterDate.html"),controller:"EditorFilterDateController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterDate",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterDate/editorFilterDate.html",'\n<div class="filter-date-wrapper">\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div class="filter-start">\n            <div class="editor-date">\n                <input data-date-time="" data-ng-model="vm.filterValueStartDate" data-format="YYYY-MM-DD" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/>\n            </div>\n            <div class="editor-time">\n                <input data-ng-disabled="!vm.filterValueStartDate" data-date-time="" data-ng-model="vm.filterValueStartTime" data-format="HH:mm:ss" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm"/>\n            </div>\n        </div><span class="divider">-</span>\n        <div class="filter-end">\n            <div class="editor-date">\n                <input data-date-time="" data-ng-model="vm.filterValueEndDate" data-format="YYYY-MM-DD" data-max-view="year" data-min-view="date" data-view="date" class="form-control input-sm"/>\n            </div>\n            <div class="editor-time">\n                <input data-ng-disabled="!vm.filterValueEndDate" data-date-time="" data-ng-model="vm.filterValueEndTime" data-format="HH:mm:ss" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm"/>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){var a=this;a.filterName=e.filter.name,a.filterDisplayName=e.filter.label,a.filterValueStartDateTime="",a.filterValueEndDateTime="",t.addFilterController(this),this.getFilterValue=function(){var e={};return(""!==a.filterValueStartDateTime||""!==a.filterValueEndDateTime)&&(""!==a.filterValueStartDateTime&&""===a.filterValueEndDateTime?e[a.filterName]=">="+i.utc(a.filterValueStartDateTime).format("YYYY-MM-DD HH:mm:ss"):""===a.filterValueStartDateTime&&""!==a.filterValueEndDateTime?e[a.filterName]="<="+i.utc(a.filterValueEndDateTime).format("YYYY-MM-DD HH:mm:ss"):(e[a.filterName]=[],
e[a.filterName].push(">="+i.utc(a.filterValueStartDateTime).format("YYYY-MM-DD HH:mm:ss")),e[a.filterName].push("<="+i.utc(a.filterValueEndDateTime).format("YYYY-MM-DD HH:mm:ss"))),e)},this.getInitialValue=function(){var e={};return e[a.filterName]="",e},this.setInitialValue=function(){a.filterValueStartDateTime="",a.filterValueEndDateTime=""},e.$on("$destroy",function(){t.deleteFilterController(a)})}angular.module("universal.editor").controller("EditorFilterDateTimeController",e),e.$inject=["$scope","FilterFieldsStorage","moment"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFilterDatetime/editorFilterDatetime.html"),controller:"EditorFilterDateTimeController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterDatetime",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterDatetime/editorFilterDatetime.html",'\n<div class="filter-datetime-wrapper">\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div class="filter-start">\n            <div class="editor-datetime">\n                <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.filterValueStartDateTime" view="date" timezone="UTC" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/>\n            </div>\n        </div><span class="divider">-</span>\n        <div class="filter-end">\n            <div class="editor-datetime">\n                <input date-time="" name="{{vm.fieldName}}" data-ng-disabled="vm.readonly" ng-model="vm.filterValueEndDateTime" view="date" timezone="UTC" format="YYYY-MM-DD HH:mm:ss" class="form-control input-sm"/>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){var a=this;a.filterName=e.filter.name,a.filterDisplayName=e.filter.label,a.filterValue=null,a.selectedValues=[];var n=e.filter.valuesRemote;a.field_id="id",a.field_search="title",n&&n.fields&&(n.fields.value&&(a.field_id=n.fields.value),n.fields.label&&(a.field_search=n.fields.label)),t.addFilterController(this),e.filter.hasOwnProperty("values")?angular.forEach(e.filter.values,function(e,t){var i={};i[a.field_id]=t,i[a.field_search]=e,a.selectedValues.push(i)}):e.filter.hasOwnProperty("valuesRemote")?i.getUrlResource(e.filter.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){a.selectedValues.push(e)})},function(t){console.error('EditorFilterRadiolistController: Не удалось получить значения для поля "'+e.filter.fieldName+'" с удаленного ресурса')}):console.error("EditorFilterRadiolistController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFilterValue=function(){var e={};return!!a.filterValue&&(e[a.filterName]=a.filterValue,e)},this.getInitialValue=function(){var e={};return e[a.filterValue]=null,e},this.setInitialValue=function(){a.filterValue=null},e.$on("$destroy",function(){t.deleteFilterController(a)})}angular.module("universal.editor").controller("EditorFilterRadiolistController",e),e.$inject=["$scope","FilterFieldsStorage","RestApiService"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFilterRadiolist/editorFilterRadiolist.html"),controller:"EditorFilterRadiolistController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterRadiolist",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterRadiolist/editorFilterRadiolist.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <label data-ng-repeat="item in vm.selectedValues" class="radio-inline">\n            <input type="radio" data-ng-model="vm.filterValue" value="{{item[vm.field_id]}}"/>{{item[vm.field_search]}}\n        </label>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a,n){var l=this,r=e.filter.valuesRemote;l.field_id="id",l.field_search="title",r&&r.fields&&(r.fields.value&&(l.field_id=r.fields.value),r.fields.label&&(l.field_search=r.fields.label)),l.filterName=e.filter.name,l.filterDisplayName=e.filter.label,l.selectedValues=[],t.addFilterController(this),e.filter.hasOwnProperty("values")?(angular.forEach(e.filter.values,function(e,t){var i={};i[l.field_id]=t,i[l.field_search]=e,l.selectedValues.push(i)}),a.search()[l.filterName]&&(l.filterValue=parseInt(a.search()[l.filterName]))):e.filter.hasOwnProperty("valuesRemote")?i.getUrlResource(e.filter.valuesRemote.url).then(function(e){angular.forEach(e.data.items,function(e){l.selectedValues.push(e)}),a.search()[l.filterName]&&(l.filterValue=parseInt(a.search()[l.filterName]))},function(t){console.error('EditorFilterSelectController: Не удалось получить значения для поля "'+e.filter.fieldName+'" с удаленного ресурса')}):console.error("EditorFilterSelectController: Для поля не указан ни один тип получения значений ( локальный или удаленный )"),this.getFilterValue=function(){var e={};return null!==l.filterValue&&(e[l.filterName]=l.filterValue,e)},this.getInitialValue=function(){var e={};return e[l.filterValue]=[],e},this.setInitialValue=function(){l.filterValue=null},e.$on("$destroy",function(){t.deleteFilterController(l)}),e.$watch(function(){return l.filterValue},function(e){void 0!==e&&a.search(l.filterName,e)})}angular.module("universal.editor").controller("EditorFilterSelectController",e),e.$inject=["$scope","FilterFieldsStorage","RestApiService","$location","$timeout"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFilterSelect/editorFilterSelect.html"),controller:"EditorFilterSelectController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterSelect",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterSelect/editorFilterSelect.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <select ng-options="item[vm.field_id] as item[vm.field_search] for item in vm.selectedValues" data-ng-model="vm.filterValue" class="form-control">\n            <option value="">--- {{\'SELECT_VALUE\' | translate}} ---</option>\n        </select>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i,a){var n=this;n.filterName=e.filter.name,n.filterDisplayName=e.filter.label,n.filterValue=i.search()[n.filterName]||"",t.addFilterController(this),this.getFilterValue=function(){var e={};return""!==n.filterValue.trim()&&(e[n.filterName]=n.filterValue,e)},this.getInitialValue=function(){var e={};return e[n.filterName]="",e},this.setInitialValue=function(){n.filterValue=""},e.$on("$destroy",function(){t.deleteFilterController(n)}),e.$watch(function(){return n.filterValue},function(e){""!==e?i.search(n.filterName,e):i.search(n.filterName,null)})}angular.module("universal.editor").controller("EditorFilterStringController",e),e.$inject=["$scope","FilterFieldsStorage","$location","RestApiService"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFilterString/editorFilterString.html"),controller:"EditorFilterStringController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterString",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterString/editorFilterString.html",'\n<div>\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <input type="text" name="{{vm.filterName}}" data-ng-model="vm.filterValue" class="form-control input-sm"/>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t,i){var a=this;a.filterName=e.filter.name,a.filterDisplayName=e.filter.label,a.filterValueStartTime="",a.filterValueEndTime="",t.addFilterController(this),this.getFilterValue=function(){var e={};return(""!==a.filterValueStartTime||""!==a.filterValueEndTime)&&(""!==a.filterValueStartTime&&""===a.filterValueEndTime?e[a.filterName]=">="+i(a.filterValueStartTime).format("HH:mm:ss"):""===a.filterValueStartTime&&""!==a.filterValueEndTime?e[a.filterName]="<="+i(a.filterValueEndTime).format("HH:mm:ss"):(e[a.filterName]=[],e[a.filterName].push(">="+i(a.filterValueStartTime).format("HH:mm:ss")),e[a.filterName].push("<="+i(a.filterValueEndTime).format("HH:mm:ss"))),e)},this.getInitialValue=function(){var e={};return e[a.filterName]="",e},this.setInitialValue=function(){a.filterValueStartTime="",a.filterValueEndTime=""},e.$on("$destroy",function(){t.deleteFilterController(a)})}angular.module("universal.editor").controller("EditorFilterTimeController",e),e.$inject=["$scope","FilterFieldsStorage","moment"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:!0,template:e.get("module/directives/editorFilterTime/editorFilterTime.html"),controller:"EditorFilterTimeController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("editorFilterTime",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/editorFilterTime/editorFilterTime.html",'\n<div class="filter-time-wrapper">\n    <div class="filter-name-label"><span>{{vm.filterDisplayName}}</span></div>\n    <div class="filter-inner-wrapper">\n        <div class="filter-start">\n            <div class="editor-time">\n                <input data-date-time="" data-ng-model="vm.filterValueStartTime" data-format="HH:mm:ss" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm"/>\n            </div>\n        </div><span class="divider">-</span>\n        <div class="filter-end">\n            <div class="editor-time">\n                <input data-date-time="" data-ng-model="vm.filterValueEndTime" data-format="HH:mm:ss" data-max-view="hours" data-min-view="minutes" data-view="hours" class="form-control input-sm"/>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(e,t){var i=this;i.error=[];var a=t.getEntityObject();e.parentField?angular.forEach(a.tabs,function(t){angular.forEach(t.fields,function(t){t.name==e.parentField&&angular.forEach(t.fields,function(t){if(t.name==e.fieldName)return void(e.field=t)})})}):angular.forEach(a.tabs,function(t){angular.forEach(t.fields,function(t){if(t.name==e.fieldName)return void(e.field=t)})}),i.fieldDisplayName=e.field.label,i.hint=e.field.hint||!1,i.required=e.field.required||!1,i.isArray="array"==e.field.type}angular.module("universal.editor").controller("FieldWrapperController",e),e.$inject=["$scope","RestApiService"]}(),function(){"use strict";function e(e,t,i,a){function n(e,i,n,l){var r=i.find(".field-element");i.on("$destroy",function(){e.$destroy()}),a(function(){r.addClass("field-wrapper-"+e.field.type)},0),r.append(new t(e).build())}return{restrict:"A",replace:!0,scope:{fieldName:"@",parentField:"@",parentFieldIndex:"@"},template:e.get("module/directives/fieldWrapper/fieldWrapper.html"),controller:"FieldWrapperController",controllerAs:"vm",link:n}}angular.module("universal.editor").directive("fieldWrapper",e),e.$inject=["$templateCache","FieldBuilder","configData","$timeout"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/fieldWrapper/fieldWrapper.html",'\n<div class="field-wrapper">\n    <div data-ng-class="!vm.isArray ? \'row\' : \'\' ">\n        <div data-ng-if="!vm.isArray" class="field-name-label col-lg-6 col-md-6 col-sm-6 col-xs-6">\n            <div data-ng-if="vm.hint" class="field-hint">\n                <div class="hint-text">{{vm.hint}}</div>\n            </div><span data-ng-class="vm.required ? \'editor-required\' : \'\' ">{{vm.fieldDisplayName}}:</span>\n        </div>\n        <div class="field-element"></div>\n    </div>\n    <div data-ng-if="!vm.isArray" class="field-error-wrapper">\n        <div data-ng-repeat="err in vm.error track by $index" class="error-item alert alert-danger">{{err}}</div>\n    </div>\n</div>')}])}(),function(){"use strict";function e(){}angular.module("universal.editor").controller("FilterWrapperController",e),e.$inject=[]}(),function(){"use strict";function e(e,t,i,a){function n(e,i,n,l){i.on("$destroy",function(){e.$destroy()}),i.ready(function(){i.find("input").bind("keydown",function(e){13==e.which&&e.preventDefault()})});var r=a.getEntityObject();angular.forEach(r.tabs,function(t){angular.forEach(t.fields,function(t){if(t.name==e.filterName)return void(e.filter=t)})}),i.append(new t(e).build())}return{restrict:"A",replace:!0,scope:{filterName:"@"},template:e.get("module/directives/filterWrapper/filterWrapper.html"),controller:"FilterWrapperController",controllerAs:"vm",link:n}}angular.module("universal.editor").directive("filterWrapper",e),e.$inject=["$templateCache","FilterBuilder","configData","RestApiService"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/filterWrapper/filterWrapper.html",'\n<div class="filter-wrapper"></div>')}])}(),function(){"use strict";function e(e,t,i,a,n,l,r,d,o,u,s,c,m,f){function p(e){var t=F.tableFields.findIndex(function(t){return t.field===e});return t!==-1}function v(){"exist"===F.editorEntityType?F.isDropdownForm=!1:"new"===F.editorEntityType&&"create"===l.search()["if-not-exist"]?F.isDropdownForm=!1:F.isDropdownForm=!0}e.entity=a.getEntityType();var g,h,y,b=a.getEntityObject(),F=this,V=3;if(tinyMCE.baseURL="../assets/mce-files",F.assetsPath="../assets",void 0===e.entity||angular.isUndefined(b))return void console.error('Editor: Сущность с типом "'+e.entity+'" не описана в конфигурационном файле');F.multilanguage=a.getMultilanguage(),F.lang=F.multilanguage[e.entity].choose,F.menu=[],F.menuLangList=[],F.langs=F.multilanguage[e.entity].langs,F.correctEntityType=!0,F.entityLoaded=!1,F.listLoaded=!1,F.loadingData=!0,F.tabs=b.tabs,F.tableFields=[],F.items=[],F.links=[],F.errors=[],F.notifys=[],F.tabsVisibility=[],F.currentTab=F.tabs[0].label,F.entityId="",F.editorEntityType="new",F.sortField="",F.sortingDirection=!0,F.pageItemsArray=[],F.contextLinks=b.contextMenu,F.listHeaderBar=b.listHeaderBar,F.editFooterBarNew=[],F.editFooterBarExist=[],F.contextId=void 0,F.isDropdownForm=!0,F.idField="id",F.parentButton=!1,F.filterFields=[],F.visibleFilter=!0,F.pagination=!b.backend.hasOwnProperty("pagination")||b.backend.pagination,F.autoCompleteFields=[],F.entityType=e.entity;for(var $ in F.multilanguage){var E={};E.name=$,E.label=F.multilanguage[$].label,E.href="#/editor/"+$+"/list"+(F.multilanguage[$].langs.length?"?lang="+F.multilanguage[$].choose:""),F.menu.push(E)}F.multilanguage[e.entity].langs.forEach(function(t){var i={};i.label=t,i.href="#/editor/"+e.entity+"/list?lang="+t,F.menuLangList.push(i)}),b.backend.hasOwnProperty("fields")&&(F.idField=b.backend.fields.primaryKey||F.idField);var x=a.getMixModeByEntity();if(x.existence){F.subType=x.entityTypeName||"type",F.mixEntityType=x.entity;var _=i.entities.filter(function(e){return e.name===F.mixEntityType})[0];_.length>1?_.forEach(function(e){e.lang===F.lang&&(y=e)}):y=_[0],F.mixedListHeaderBar=y.listHeaderBar,F.mixContextLinks=y.contextMenu}F.metaKey=!1,g="_meta",h="items",angular.forEach(b.tabs,function(e){angular.forEach(e.fields,function(e){e.list===!0&&(e.valuesRemote||e.values)&&F.autoCompleteFields.push(e),e.hasOwnProperty("list")&&e.list===!0&&F.tableFields.push({field:e.name,displayName:e.label||e.name})})}),angular.forEach(b.editFooterBar,function(e){switch(e.type){case"add":F.editFooterBarNew.push(e);break;case"presave":F.editFooterBarNew.push(e),F.editFooterBarExist.push(e);break;case"update":F.editFooterBarExist.push(e);break;case"delete":F.editFooterBarExist.push(e);break;case"request":F.editFooterBarNew.push(e),F.editFooterBarExist.push(e);break;case"targetBlank":F.editFooterBarNew.push(e),F.editFooterBarExist.push(e);break;case"download":F.editFooterBarNew.push(e),F.editFooterBarExist.push(e)}}),x.existence&&angular.forEach(y.tabs,function(e){angular.forEach(e.fields,function(e){e.hasOwnProperty("list")&&e.list===!0&&!p(e.name)&&F.tableFields.push({field:e.name,displayName:e.label||e.name})})}),F.sortField=b.backend.sortBy||F.tableFields[0].field,angular.forEach(F.tabs,function(e,t){e.fields.length>0?(F.tabsVisibility.push(e.fields[0].name),angular.forEach(e.fields,function(e){e.hasOwnProperty("filterable")&&e.filterable===!1||F.filterFields.push(e)})):F.tabsVisibility.push("")}),F.getScope=function(){return e},F.setTabVisible=function(e,t){F.tabsVisibility[e]=t},F.closeEditor=function(){e.$apply(function(){F.entityLoaded=!1})},F.closeButton=function(){F.entityLoaded=!1,F.listLoaded=!1;var e={},t=!1;u.params.back&&(e.back=u.params.back),u.params.parent&&(e.parent=u.params.parent,t=!1),F.langSelect&&(e.lang=F.langSelect),u.go("editor.type.list",e,{reload:t})},F.applyFilter=function(){a.setFilterParams(n.getFilterValue()),a.getItemsList()},F.clearFilter=function(){n.setInitialValues(),a.setFilterParams({}),a.getItemsList()},a.isProcessing||F.clearFilter(),F.changePage=function(e,t){e.preventDefault(),F.listLoaded=!1;var i=t.split("?")[1];a.getItemsListWithParams(i)},F.changeSortField=function(e){F.listLoaded=!1,F.sortField==e?F.sortingDirection=!F.sortingDirection:F.sortField=e;({sort:F.sortingDirection?e:"-"+e});a.getItemsList({sort:F.sortingDirection?e:"-"+e})},F.contextAction=function(e,t){a.contextMenuAction(e,t)},F.toggleContextView=function(e){F.contextId==e?F.contextId=void 0:F.contextId=e},F.getParent=function(){a.loadParent(l.search().parent)},F.toggleFilterVisibility=function(){F.entityLoaded||(F.visibleFilter=!F.visibleFilter)},a.setQueryParams({sort:F.sortingDirection?F.sortField:"-"+F.sortField}),t.$broadcast("editor:set_entity_type",e.entity),e.$on("editor:items_list",function(e,t){F.metaKey=!0,F.listLoaded=!0,F.items=t[h],angular.isDefined(b.backend.keys)&&(g=b.backend.keys.meta||g,h=b.backend.keys.items||h,F.metaKey=0!=b.backend.keys.meta),F.autoCompleteFields.forEach(function(e){if(0!==F.autoCompleteFields.length){var t=e.name,i=[],n="";if(t&&e.valuesRemote&&e.valuesRemote.fieldSearch&&(F.items.forEach(function(e){var a=e[t];e[t+"_copy"]=a,e[t]="",a&&i.indexOf(a)===-1&&i.push(a)}),i.length&&(n='?filter={"'+e.valuesRemote.fieldId+'":['+i.join(",")+"]}"),a.getData(e.valuesRemote.url+n).then(function(i){if(i.data.items&&i.data.items.length){F.linkedNames=i.data.items;for(var a=F.linkedNames.length;a--;){var n=F.linkedNames[a];n&&F.items.forEach(function(i){i[t+"_copy"]==n.id&&(i[t]=n[e.valuesRemote.fieldSearch])})}}},function(e){console.log(e)})),e.values)for(var l=F.items.length;l--;){var r=F.items[l][t];F.items[l][t]=e.values[r]||r}}}),F.entityLoaded=!1,F.parentButton=!!l.search().hasOwnProperty("parent"),F.pageItemsArray=[];var i,n,r=a.getQueryParams();if(0===F.items.length&&(F.metaKey=!1),F.pagination&&F.metaKey){for(F.metaData=t[g],F.metaData.fromItem=(t[g].currentPage-1)*t[g].perPage+1,F.metaData.toItem=(t[g].currentPage-1)*t[g].perPage+t[h].length,t[g].currentPage>1&&(r.page=1,F.pageItemsArray.push({label:"<<",href:b.backend.url+"?"+o(r)}),r.page=t[g].currentPage-1,F.pageItemsArray.push({label:"<",href:b.backend.url+"?"+o(r)})),t[g].currentPage>V+1&&(r.page=t[g].currentPage-V-1,F.pageItemsArray.push({label:"...",href:b.backend.url+"?"+o(r)})),i=t[g].currentPage-V>0?t[g].currentPage-V:1;i<t[g].currentPage;)r.page=i,F.pageItemsArray.push({label:i,href:b.backend.url+"?"+o(r)}),i++;F.pageItemsArray.push({label:t[g].currentPage,self:!0}),n=t[g].currentPage+V<t[g].pageCount?t[g].currentPage+V:t[g].pageCount;for(var d=t[g].currentPage+1;d<=n;)r.page=d,F.pageItemsArray.push({label:d,href:b.backend.url+"?"+o(r)}),d++;t[g].currentPage+V<t[g].pageCount&&(r.page=t[g].currentPage+V+1,F.pageItemsArray.push({label:"...",href:b.backend.url+"?"+o(r)})),t[g].currentPage<t[g].pageCount&&(r.page=t[g].currentPage+1,F.pageItemsArray.push({label:">",href:b.backend.url+"?"+o(r)}),r.page=t[g].pageCount,F.pageItemsArray.push({label:">>",href:b.backend.url+"?"+o(r)}))}}),e.$on("editor:entity_loaded",function(e,t){F.editorEntityType=t.editorEntityType,F.entityId=t[F.idField],F.entityLoaded=!0,v()}),e.$on("editor:server_error",function(e,t){F.errors.push(t)}),e.$on("editor:presave_entity_created",function(e,t){m("CHANGE_RECORDS.CREATE").then(function(e){c.success(e)}),F.entityId=t,F.editorEntityType="exist",v()}),e.$on("editor:presave_entity_updated",function(e,t){m("CHANGE_RECORDS.UPDATE").then(function(e){c.success(e)})}),e.$on("editor:parent_childs",function(e,t){angular.forEach(F.items,function(e,i){var a=1;e[F.idField]===t.id&&(e.isExpand===!0?(e.isExpand=!1,F.items.splice(i+1,t.childs.length)):(e.isExpand=!0,angular.forEach(t.childs,function(e){F.items[i].hasOwnProperty.parentPadding?e.parentPadding=F.items[i].parentPadding+1:e.parentPadding=1,F.items.splice(i+a,0,e)})))})}),e.$on("editor:entity_success_deleted",function(e,t){m("CHANGE_RECORDS.DELETE").then(function(e){c.success(e)})}),e.$on("editor:field_error",function(e,t){F.errors.push(t)}),e.$on("editor:request_start",function(e,t){F.errors=[],F.notifys=[]}),r.on("click",function(e){angular.element(e.target).hasClass("context-toggle")||d(function(){F.contextId=void 0},0)}),e.$watch(function(){return a.isProcessing},function(e){F.loadingData=e}),i.hasOwnProperty("ui")&&i.ui.hasOwnProperty("language")&&(i.ui.language.search(".json")!==-1?m.use(i.ui.language):"ru"!==i.ui.language&&m.use("assets/json/language/"+i.ui.language+".json")),F.clickEnter=function(e){13===e.keyCode&&F.applyFilter()}}angular.module("universal.editor").controller("UniversalEditorController",e),e.$inject=["$scope","$rootScope","configData","RestApiService","FilterFieldsStorage","$location","$document","$timeout","$httpParamSerializer","$state","configObject","toastr","$translate","ConfigDataProvider"]}(),function(){"use strict";function e(e){function t(e,t,i,a){t.on("$destroy",function(){e.$destroy()})}return{restrict:"A",replace:!0,scope:{entity:"@"},template:e.get("module/directives/universalEditor/universalEditor.html"),controller:"UniversalEditorController",controllerAs:"vm",link:t}}angular.module("universal.editor").directive("universalEditor",e),e.$inject=["$templateCache"]}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/universalEditor/universalEditor.html",'\n<div class="universal-editor">\n    <div class="field-error-wrapper">\n        <div data-ng-repeat="err in vm.errors" class="error-item">{{err}}</div>\n    </div>\n    <div class="field-notify-wrapper">\n        <div data-ng-repeat="notify in vm.notifys" class="notify-item">{{notify}}</div>\n    </div>\n    <div data-ng-if="vm.correctEntityType">\n        <div class="editor-header">\n            <button data-ng-click="vm.toggleFilterVisibility()" data-ng-class="{ disabled : vm.entityLoaded }" class="header-action-button gray">{{ \'BUTTON.FILTER\' | translate}} {{ vm.visibleFilter ? "+" : "-" }}</button>\n            <div ng-repeat="button in vm.listHeaderBar track by $index" class="header-action-button">\n                <div data-editor-button-create="" data-button-label="{{button.label}}" ng-if="button.type === \'create\'" data-type="entity"></div>\n                <div data-ng-if="button.type == \'custom\'" data-ng-click="vm.headerAction(button)">{{button.label}}</div>\n            </div>\n            <div ng-repeat="button in vm.mixedListHeaderBar track by $index" class="header-action-button">\n                <div data-editor-button-create="" data-button-label="{{button.label}}" ng-if="button.type === \'create\'" data-type="vm.mixEntityType"></div>\n                <div data-ng-if="button.type == \'custom\'" data-ng-click="vm.headerAction(button)">{{button.label}}</div>\n            </div>\n        </div>\n        <div data-ng-hide="vm.visibleFilter || (vm.entityLoaded || vm.loadingData)" class="editor-filter">\n            <div class="editor-filter-wrapper">\n                <div data-ng-repeat="filter in vm.filterFields" data-filter-wrapper="" data-filter-name="{{filter.name}}"></div>\n                <div class="buttons-wrapper">\n                    <button data-ng-click="vm.applyFilter()" class="editor-action-button gray">{{\'BUTTON.APPLY\' | translate}}</button>\n                    <button data-ng-click="vm.clearFilter()" class="editor-action-button gray">{{\'BUTTON.CLEAN\' | translate}}</button>\n                </div>\n            </div>\n        </div>\n        <div class="groups-action">\n            <button data-ng-if="vm.parentButton &amp;&amp; !vm.entityLoaded &amp;&amp; !vm.loadingData" data-ng-click="vm.getParent()" class="editor-action-button gray">{{\'BUTTON.HIGHER_LEVEL\' | translate}}</button>\n        </div>\n        <div data-ng-show="vm.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n        </div>\n        <table data-ng-hide="vm.entityLoaded || vm.loadingData" class="items-list">\n            <thead>\n                <tr>\n                    <td class="actions-header context-column"></td>\n                    <td data-ng-repeat="fieldItem in vm.tableFields" data-ng-class="{ \'active\' : fieldItem.field == vm.sortField, \'asc\' : vm.sortingDirection, \'desc\' : !vm.sortingDirection}" data-ng-click="vm.changeSortField(fieldItem.field)">{{fieldItem.displayName}}</td>\n                </tr>\n            </thead>\n            <tbody data-ng-if="vm.listLoaded">\n                <tr data-ng-repeat="item in vm.items">\n                    <td class="context-column"><span data-ng-click="vm.toggleContextView(item[vm.idField])" data-ng-show="vm.contextLinks.length" class="context-toggle">Toggle buttons</span>\n                        <div data-ng-show="vm.contextId == item[vm.idField]" class="context-menu-wrapper">\n                            <div data-ng-repeat="link in vm.contextLinks track by $index" class="context-menu-item">\n                                <div data-ng-if="link.type == \'custom\'" data-ng-click="vm.contextAction($index,item[vm.idField])">{{link.label}}</div>\n                                <div data-ng-if="link.type == \'edit\'" data-editor-button-edit="" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-params="{{link.params}}"></div>\n                                <div data-ng-if="link.type == \'delete\'" data-editor-button-delete="" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-params="{{link.params}}"></div>\n                                <div data-ng-if="link.type == \'open\'" data-editor-button-open="" data-entity-id="{{item[vm.idField]}}" data-entity-type="" data-button-label="{{link.label}}" data-button-params="{{link.params}}"></div>\n                                <div data-ng-if="link.type == \'download\'" data-editor-button-download="" data-item-value="{{item}}" data-button-label="{{link.label}}" data-button-params="{{link.params}}" data-index="{{$index}}"></div>\n                                <div data-ng-if="link.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="{{item}}" data-button-label="{{link.label}}" data-button-params="link.request" data-index="{{$index}}"></div>\n                            </div>\n                        </div>\n                    </td>\n                    <td data-ng-repeat="fieldItem in vm.tableFields"><span style="padding-left: {{ item.parentPadding ? item.parentPadding * 10 : 0 }}px">{{item[fieldItem.field]}}</span></td>\n                </tr>\n                <tr data-ng-if="vm.items.length == 0">\n                    <td colspan="{{vm.tableFields.length + 1}}">{{\'ELEMENT_NO\' | translate}}</td>\n                </tr>\n            </tbody>\n            <tfoot data-ng-if="vm.pagination">\n                <tr>\n                    <td colspan="{{vm.tableFields.length + 1}}">\n                        <div class="meta-info">{{\'ELEMENTS\' | translate}} {{vm.metaData.fromItem}} - {{vm.metaData.toItem}} {{\'FROM\' | translate}} {{vm.metaData.totalCount}}</div>\n                    </td>\n                </tr>\n                <tr>\n                    <td colspan="{{vm.tableFields.length + 1}}">\n                        <div class="links-wrapper">\n                            <div data-ng-repeat="pageItem in vm.pageItemsArray"><a data-ng-if="!pageItem.self" href="{{pageItem.href}}" data-ng-click="vm.changePage(pageItem.href)">{{pageItem.label}}</a><span data-ng-if="pageItem.self">{{pageItem.label}}</span></div>\n                        </div>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n        <div data-ng-show="vm.entityLoaded" class="editor-body">\n            <div data-ng-click="vm.closeButton()" ng-style="{\'background-image\':\'url(\'+ vm.assetsPath +\'/images/close.jpg)\'}" class="close-editor"></div>\n            <div class="tab-label-wrapper">\n                <div data-ng-repeat="(tkey,tab) in vm.tabs" data-ng-class="vm.currentTab == tab.label ? \'active\' : \'\'" data-ng-click="vm.currentTab = tab.label" class="tab-item-label">\n                    <div>{{tab.label}}</div>\n                </div>\n            </div>\n            <div class="tab-content-wrapper">\n                <div data-ng-repeat="(tkey,tab) in vm.tabs" data-ng-show="vm.currentTab == tab.label" class="tab-item-content">\n                    <div class="field-content-wrapper">\n                        <div data-ng-repeat="field in tab.fields" data-field-wrapper="" data-field-name="{{field.name}}"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="field-error-bottom-wrapper">\n                <div data-ng-repeat="err in vm.errors" class="error-item">{{err}}</div>\n            </div>\n            <div class="field-notify-bottom-wrapper">\n                <div data-ng-repeat="notify in vm.notifys" class="notify-item">{{notify}}</div>\n            </div>\n            <div class="editor-entity-actions">\n                <div data-ng-if="vm.getButton(\'add\') &amp;&amp; vm.editorEntityType == \'new\'" data-editor-button-add="" data-button-label="{{vm.getButton(\'add\').label}}"></div>\n                <div data-ng-if="vm.getButton(\'presave\')" data-editor-button-presave="" data-entity-id="{{vm.entityId}}" data-button-label="{{vm.getButton(\'presave\').label}}"></div>\n                <div data-ng-if="vm.getButton(\'update\') &amp;&amp; vm.editorEntityType == \'exist\'" data-editor-button-update="" data-entity-id="{{vm.entityId}}" data-button-label="{{vm.getButton(\'update\').label}}"></div>\n                <div data-ng-if="vm.getButton(\'delete\') &amp;&amp; vm.editorEntityType == \'exist\'" data-editor-button-delete="" data-entity-id="{{vm.entityId}}" data-button-label="{{vm.getButton(\'delete\').label}}"></div>\n            </div>\n        </div>\n    </div>\n</div>');
}])}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/universalEditor/universalEditorForm.html",'\n<ul data-ng-if="vm.menu.length &gt; 1" class="nav nav-tabs">\n    <li data-ng-repeat="itemMenu in vm.menu track by $index" data-ng-class="(itemMenu.name === entity) ? \'active\' : \'\'" class="item"><a href="{{itemMenu.href}}">{{itemMenu.label}}</a></li>\n</ul>\n<div class="universal-editor">\n    <div>\n        <div data-ng-show="vm.entityLoaded" class="editor-body">\n            <div data-ng-click="vm.closeButton()" ng-style="{\'background-image\':\'url(\'+ vm.assetsPath +\'/images/close.jpg)\'}" class="close-editor"></div>\n            <div class="nav nav-tabs">\n                <li data-ng-repeat="(tkey,tab) in vm.tabs" data-ng-class="vm.currentTab == tab.label ? \'active\' : \'\'" data-ng-click="vm.currentTab = tab.label"><a href="">{{tab.label}}</a></li>\n            </div>\n            <div data-ng-if="vm.menuLangList.length &gt; 0" class="dropdown dropdown-form">\n                <button data-toggle="dropdown" class="btn btn-default dropdown-toggle">{{vm.lang}}</button>\n                <ul class="dropdown-menu">\n                    <li data-ng-repeat="itemMenu in vm.menuLangList track by $index" data-ng-if="vm.isDropdownForm"><a data-ui-sref="editor.type.new({lang: itemMenu.label})" ui-sref-opts="{reload: true}">{{itemMenu.label}}</a></li>\n                    <li data-ng-repeat="itemMenu in vm.menuLangList track by $index" data-ng-if="!vm.isDropdownForm"><a data-ui-sref="editor.type.entity({lang: itemMenu.label, &quot;if-not-exist&quot;: &quot;create&quot;})" ui-sref-opts="{reload: true}">{{itemMenu.label}}</a></li>\n                </ul>\n            </div>\n            <div class="tab-content-wrapper">\n                <div data-ng-repeat="(tkey,tab) in vm.tabs" data-ng-show="vm.currentTab == tab.label" class="tab-item-content">\n                    <div class="field-content-wrapper">\n                        <div data-ng-repeat="field in tab.fields" data-field-wrapper="" data-field-name="{{field.name}}" data-ng-if="(vm.editorEntityType == \'new\' &amp;&amp; field.showOnly == \'create\') || (vm.editorEntityType == \'exist\' &amp;&amp; field.showOnly == \'edit\') || !field.showOnly"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="field-error-bottom-wrapper">\n                <div data-ng-repeat="err in vm.errors" class="error-item alert alert-danger">{{err}}</div>\n            </div>\n            <div class="field-notify-bottom-wrapper">\n                <div data-ng-repeat="notify in vm.notifys" class="notify-item">{{notify}}</div>\n            </div>\n            <div class="editor-entity-actions">\n                <div ng-repeat="button in (vm.editorEntityType == \'new\' ? vm.editFooterBarNew : vm.editFooterBarExist) track by $index" class="editor-action-button">\n                    <div data-ng-if="(button.type == \'add\') &amp;&amp; vm.editorEntityType == \'new\'" data-editor-button-add="" data-button-label="{{button.label}}"></div>\n                    <div data-ng-if="(button.type == \'presave\')" data-editor-button-presave="" data-entity-id="{{vm.entityId}}" data-button-request="{{button.request}}" data-button-label="{{button.label}}"></div>\n                    <div data-ng-if="(button.type == \'update\') &amp;&amp; vm.editorEntityType == \'exist\'" data-editor-button-update="" data-entity-id="{{vm.entityId}}" data-button-label="{{button.label}}"></div>\n                    <div data-ng-if="(button.type == \'delete\') &amp;&amp; vm.editorEntityType == \'exist\'" data-editor-button-delete="" data-entity-id="{{vm.entityId}}" data-button-label="{{button.label}}" data-button-class="editor"></div>\n                    <div data-ng-if="button.type == \'request\'" data-ng-click="vm.contextAction(button, vm.entityId)" class="btn btn-md btn-success">{{button.label}}</div>\n                    <div data-ng-if="button.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="editor"></div>\n                    <div data-ng-if="button.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="editor"></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}])}(),function(e){try{e=angular.module("universal.editor.templates")}catch(t){e=angular.module("universal.editor.templates",[])}e.run(["$templateCache",function(e){e.put("module/directives/universalEditor/universalEditorList.html",'\n<ul data-ng-if="vm.menu.length &gt; 1" class="nav nav-tabs">\n    <li data-ng-repeat="itemMenu in vm.menu track by $index" data-ng-class="(itemMenu.name === entity) ? \'active\' : \'\'" class="item"><a href="{{itemMenu.href}}">{{itemMenu.label}}</a></li>\n</ul>\n<div class="universal-editor">\n    <div>\n        <div class="editor-header">\n            <button data-ng-click="vm.toggleFilterVisibility()" data-ng-class="{ disabled : vm.entityLoaded }" class="btn btn-lg btn-default filter-button">{{ \'BUTTON.FILTER\' | translate}} {{ vm.visibleFilter ? "+" : "-" }}</button>\n            <div ng-repeat="button in vm.listHeaderBar track by $index" class="header-action-button">\n                <div data-ng-if="button.type == \'create\'" data-editor-button-create="" data-button-label="{{button.label}}" data-type="entity"></div>\n                <div data-ng-if="button.type == \'request\'" data-ng-click="vm.contextAction(button)" class="btn btn-lg btn-success">{{button.label}}</div>\n                <div data-ng-if="button.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="header"></div>\n                <div data-ng-if="button.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="header"></div>\n            </div>\n            <div ng-repeat="button in vm.mixedListHeaderBar track by $index" class="header-action-button">\n                <div data-ng-if="button.type == \'create\'" data-editor-button-create="" data-button-label="{{button.label}}" data-type="vm.mixEntityType"></div>\n                <div data-ng-if="button.type == \'request\'" data-ng-click="vm.contextAction(button)" class="btn btn-lg btn-success">{{button.label}}</div>\n                <div data-ng-if="button.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="header"></div>\n                <div data-ng-if="button.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{button.label}}" data-button-request="{{button.request}}" data-index="{{$index}}" data-button-class="header"></div>\n            </div>\n            <div data-ng-if="vm.menuLangList.length &gt; 0" class="dropdown header-action-button">\n                <button data-toggle="dropdown" class="btn btn-default dropdown-toggle">{{vm.lang}}</button>\n                <ul class="dropdown-menu">\n                    <li data-ng-repeat="itemMenu in vm.menuLangList track by $index"><a data-ui-sref="editor.type.list({lang: itemMenu.label})" ui-sref-opts="{reload: true}">{{itemMenu.label}}</a></li>\n                </ul>\n            </div>\n        </div>\n        <div data-ng-hide="vm.visibleFilter || (vm.entityLoaded || vm.loadingData)" class="editor-filter">\n            <div ng-keyup="vm.clickEnter($event)" class="editor-filter-wrapper">\n                <div data-ng-repeat="filter in vm.filterFields" data-filter-wrapper="" data-filter-name="{{filter.name}}"></div>\n                <div class="buttons-wrapper">\n                    <button data-ng-click="vm.applyFilter()" class="btn btn-sm btn-success">{{\'BUTTON.APPLY\' | translate}}</button>\n                    <button data-ng-click="vm.clearFilter()" class="btn btn-sm btn-default">{{\'BUTTON.CLEAN\' | translate}}</button>\n                </div>\n            </div>\n        </div>\n        <div class="groups-action">\n            <button data-ng-if="vm.parentButton &amp;&amp; !vm.entityLoaded &amp;&amp; !vm.loadingData" data-ng-click="vm.getParent()" class="btn btn-sm btn-default">{{\'BUTTON.HIGHER_LEVEL\' | translate}}</button>\n        </div>\n        <div data-ng-show="vm.loadingData" class="processing-status-wrapper">\n            <div class="processing-status">{{\'PERFORMS_ACTIONS\' | translate}}</div>\n        </div>\n        <table data-ng-hide="vm.entityLoaded || vm.loadingData" class="table table-bordered items-list">\n            <thead>\n                <tr>\n                    <td class="actions-header context-column"></td>\n                    <td data-ng-repeat="fieldItem in vm.tableFields" data-ng-class="{ \'active\' : fieldItem.field == vm.sortField, \'asc\' : vm.sortingDirection, \'desc\' : !vm.sortingDirection}" data-ng-click="vm.changeSortField(fieldItem.field)">{{fieldItem.displayName}}</td>\n                </tr>\n            </thead>\n            <tbody data-ng-if="vm.listLoaded">\n                <tr data-ng-repeat="item in vm.items" data-ng-class="{\'zhs-item\' : (vm.entityType !== item[vm.subType]) &amp;&amp; item[vm.subType] !== undefined}">\n                    <td class="context-column"><span data-ng-click="vm.toggleContextView(item[vm.idField])" data-ng-show="vm.contextLinks.length" class="context-toggle">Toggle buttons</span>\n                        <div data-ng-show="vm.contextId == item[vm.idField]" class="context-menu-wrapper">\n                            <div data-ng-repeat="link in vm.contextLinks track by $index" data-ng-if="(item[vm.subType] == vm.entityType || item[vm.subType] == undefined)" class="context-menu-item">\n                                <div data-ng-if="link.type == \'request\'" data-ng-click="vm.contextAction(link,item[vm.idField])">{{link.label}}</div>\n                                <div data-ng-if="link.type == \'edit\'" data-editor-button-edit="" data-entity-subtype="{{item[vm.subType]}}" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}"></div>\n                                <div data-ng-if="link.type == \'delete\'" data-editor-button-delete="" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-button-class="context"></div>\n                                <div data-ng-if="link.type == \'open\'" data-editor-button-open="" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}"></div>\n                                <div data-ng-if="link.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-index="{{$index}}" data-button-class="context"></div>\n                                <div data-ng-if="link.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-index="{{$index}}" data-button-class="context"></div>\n                            </div>\n                            <div data-ng-repeat="link in vm.mixContextLinks track by $index" data-ng-if="vm.mixEntityType &amp;&amp; item[vm.subType] === vm.mixEntityType" class="context-menu-item">\n                                <div data-ng-if="link.type == \'request\'" data-ng-click="vm.contextAction(link,item[vm.idField])">{{link.label}}</div>\n                                <div data-ng-if="link.type == \'edit\'" data-editor-button-edit="" data-entity-subtype="{{item[vm.subType]}}" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}"></div>\n                                <div data-ng-if="link.type == \'delete\'" data-editor-button-delete="" data-entity-id="{{item[vm.idField]}}" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-button-class="context"></div>\n                                <div data-ng-if="link.type == \'download\'" data-editor-button-download="" data-item-value="item" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-index="{{$index}}" data-button-class="context"></div>\n                                <div data-ng-if="link.type == \'targetBlank\'" data-editor-button-target-blank="" data-item-value="item" data-button-label="{{link.label}}" data-button-request="{{link.request}}" data-index="{{$index}}" data-button-class="context"></div>\n                            </div>\n                        </div>\n                    </td>\n                    <td data-ng-repeat="fieldItem in vm.tableFields track by $index"><span style="padding-left: {{ item.parentPadding ? item.parentPadding * 10 : 0 }}px;">{{item[fieldItem.field]}}</span></td>\n                </tr>\n                <tr data-ng-if="vm.items.length == 0">\n                    <td colspan="{{vm.tableFields.length + 1}}">{{\'ELEMENT_NO\' | translate}}</td>\n                </tr>\n            </tbody>\n            <tfoot>\n                <tr data-ng-if="vm.metaKey">\n                    <td colspan="{{vm.tableFields.length + 1}}">\n                        <div class="meta-info">{{\'ELEMENTS\' | translate}} {{vm.metaData.fromItem}} - {{vm.metaData.toItem}} {{\'FROM\' | translate}} {{vm.metaData.totalCount}}</div>\n                    </td>\n                </tr>\n                <tr>\n                    <td colspan="{{vm.tableFields.length + 1}}" data-ng-if="vm.pagination &amp;&amp; vm.metaKey">\n                        <ul class="pagination">\n                            <li data-ng-repeat="pageItem in vm.pageItemsArray" data-ng-class="pageItem.self ? \'active\' : \'\'"><a data-ng-if="!pageItem.self" href="{{pageItem.href}}" data-ng-click="vm.changePage($event,pageItem.href)">{{pageItem.label}}</a><span data-ng-if="pageItem.self">{{pageItem.label}}</span></li>\n                        </ul>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n</div>')}])}();